<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ovelny - chaos/web-exploitation/IDOR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="ovelny - notes on infosec, penetration testing, programming and others"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" type=text/css href="/assets/css/dead-simple.min.css">
    <link rel="stylesheet" type=text/css href="/assets/css/rouge.min.css">
    <link
      href="/atom.xml"
      rel="alternate"
      title="ovelny"
      type="application/atom+xml"
    />
    <script src="/assets/js/scramble-text.min.js" defer></script>
    <script src="/assets/js/zoom-images.min.js" defer></script>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@ovelny"/>
    <meta name="twitter:title" content="ovelny - chaos/web-exploitation/IDOR"/>
    <meta name="twitter:image" content="https://ovelny.sh/assets/images/ovelny-logo.png"/>
    <meta name="twitter:image:alt" content="ovelny logo: 6 white circles grouped together forming a triangle shape, with a black background."/>
  </head>
  <body>

    <header>
      <section>
        <a href="/">
          <img
            class="logo"
            src="/assets/images/ovelny-pfp.png"
            alt="ovelny profile picture: a glitched picture of a three-eyed girl, staring intensely at the viewer."
          />
        </a>
        <h2><a class="ovelny" href="/">ovelny</a></h2>
      </section>
      <nav>
        <a href="/now/">now</a>
        <a href="/chaos/">chaos</a>
        <a href="/phasm/">phasm</a>
        <a href="/support/">support</a>
        <a href="/atom.xml" target="_blank" rel="noopener noreferrer">rss</a>
        <a href="/about/">about</a>
      </nav>
    </header>
    <main>

    
    <h1>IDOR</h1>

<p>Insecure Direct Object Reference (IDOR) vulnerabilities occur when a direct reference to an object can be controlled and modified by the user to access other similar objects. in other words, this means that a user having access to <code>/1/results.txt</code> shouldn&#39;t have access to someone else&#39;s results by accessing <code>/2/results.txt</code>. this applies not only to files, but to functions or any kind of object.</p>

<p>IDORs are among the most common web vulnerabilities, and result from a weak or absent access control system on the back-end, as they are notoriously difficult to implement across large webapps.</p>

<h2>enumerating IDORs</h2>

<p>identifying URL parameters or APIs with an object reference is the first enumeration step, such as <code>?id=1</code> or <code>?file=1.pdf</code>. those can also be found in HTTP headers at times. besides taking the obvious path and increment those values to access protected resources, we can also find potential IDORs through AJAX calls.</p>

<p>if a webapp is insecurely developed, it is possible to see AJAX admin function calls on the frontend that are simply never called by regular users using the app. if we spot an interesting AJAX call, we might try a custom HTTP request to trigger it and see if the action performed, like <code>password_change.php</code>, is indeed going through. if the backend code is open-sourced, we could also find interesting calls there and try them on the deployed target.</p>

<p>references to objects are often encoded or hashed, but that doesn&#39;t mean they&#39;re secure. if the encoding is easily reversible such as base64, we can simply decode our example, see the plain reference to the object, then increment it and encode it in base64 before sending our request to see what happens.</p>

<p>hashing is a bit trickier but depending on the implementation, we might see the plain reference before it is hashed and how it is hashed, meaning we could try to reverse it and calculate other hashes for potential filenames. this especially happens when this logic has been insecurely implemented on the front-end rather than the back-end, exposing the sensitive function to us.</p>

<p>depending on the webapp and the possible roles we can create an account for, we might benefit from registering several users and trying to access object references that they&#39;re not supposed to share with each other. even if the access is limited to basic roles, this is still an IDOR that should get reported.</p>

<h2>references</h2>

<ul>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Direct%20Object%20References" rel="nofollow">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Direct%20Object%20References</a></li>
</ul>

    
    </main>
    <footer id="footer">
      <div class="footer-section"><a href="/license/">CC BY-NC-SA 4.0</a><p>&nbsp;::&nbsp;2019 - 2025 ovelny</p></div>
      <div class="footer-section">「七転び八起き」</div>
    </footer>
  </body>
</html>

